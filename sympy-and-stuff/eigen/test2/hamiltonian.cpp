#include <chrono>

#include <iostream>
#include <math.h>
#include <Eigen/Dense>
// #include <Eigen/Core>

using namespace Eigen;
using namespace std;

const double mu1 = 14579;
const double mu2 = 36440;
const double l = 4.398; 

void inertia_tensor_dR(Matrix3d &i_dr, double &R, double &theta)
{
    i_dr(0, 0) = i_dr(1, 1) = 2 * mu2 * R;
    
    i_dr(1, 0) = i_dr(2, 0) = 0;    
    i_dr(0, 2) = i_dr(1, 2) = i_dr(2, 2) = 0;
    i_dr(0, 1) = i_dr(2, 1) = 0;
}

void inertia_tensor_dtheta(Matrix3d &i_dt, double &R, double &theta)
{
    double l2 = l * l;
    double sin_t = sin(theta);
    double cos_t = cos(theta);

    i_dt(0, 0) = - 2 * mu1 * l2 * sin_t * cos_t;
    i_dt(1, 0) = 0;
    i_dt(2, 0) = i_dt(2, 0) = - mu1 * l2 * (cos_t * cos_t - sin_t * sin_t);

    i_dt(1, 2) = 0;
    i_dt(2, 2) = - i_dt(0, 0); 

    i_dt(0, 1) = i_dt(1, 1) = i_dt(2, 1) = 0;
}

void inertia_tensor(Matrix3d &inertia_tensor, double &R, double &theta)
{
    double sin_t = sin(theta);
    double cos_t = cos(theta);
    double l2 = l * l;
    double R2 = R * R;
    
    inertia_tensor(0, 0) = mu1 * l2 * cos_t * cos_t + mu2 * R2; 
    inertia_tensor(1, 0) = 0;
    inertia_tensor(2, 0) = -mu1 * l2 * sin_t * cos_t;

    inertia_tensor(0, 2) = inertia_tensor(2, 0);
    inertia_tensor(1, 2) = 0;
    inertia_tensor(2, 2) = mu1 * l2 * sin_t * sin_t;

    inertia_tensor(0, 1) = 0;
    inertia_tensor(1, 1) = inertia_tensor(0, 0) + inertia_tensor(2, 2);
    inertia_tensor(2, 1) = 0;

    //cout << "Inertia tensor matrix:" << endl << inertia_tensor << endl;
}

void fill_a_matrix(Matrix2d &a, double &R, double &theta)
{
    a(0, 0) = mu2;
    a(0, 1) = 0;
    a(1, 0) = 0;
    a(1, 1) = mu1 * l * l;

    //cout << "a matrix:" << endl << a << endl;
}

void fill_A_matrix(Matrix<double, 3, 2> &A, double &R, double &theta)
{
    A(0, 0) = A(0, 1) = 0;
    A(1, 0) = 0;
    A(1, 1) = mu1 * l * l;
    A(2, 0) = A(2, 1) = 0;

    //cout << "A matrix:" << endl << A << endl;
}

void hamiltonian(double* out, double R, double theta, double pR, double pT, double alpha, double beta, double J)
{
    //declaring angular momentum and its derivatives
    Vector3d j_vector(J * cos(alpha) * sin(beta),
                      J * sin(alpha) * sin(beta),
                      J * cos(beta));

    Vector3d j_vector_dalpha(- J * sin(alpha) * sin(beta),
                               J * cos(alpha) * sin(beta),
                               0);
    Vector3d j_vector_dbeta(J * cos(alpha) * cos(beta),
                            J * sin(alpha) * cos(beta),
                           -J * sin(beta));
    
    Vector2d p_vector(pR, pT);

    // declaring inertia tensor and it's derivatives
    Matrix<double, 3, 3> I; 
    Matrix<double, 3, 3> I_dr;
    Matrix<double, 3, 3> I_dtheta;
    
    // declaring matrices a, A
    Matrix<double, 2, 2> a;
    Matrix<double, 3, 2> A;

    // filling matrices 
    inertia_tensor(I, R, theta); 
    inertia_tensor_dR(I_dr, R, theta);
    inertia_tensor_dtheta(I_dtheta, R, theta);
    fill_a_matrix(a, R, theta);
    fill_A_matrix(A, R, theta);

    // supplementary matrices
    Matrix<double, 3, 3> I_inv = I.inverse();
    Matrix<double, 2, 2> a_inv = a.inverse();

    Matrix<double, 3, 3> G11;
    Matrix<double, 2, 2> G22;
    Matrix<double, 3, 2> G12;
   
    Matrix<double, 3, 3> t1;
    Matrix<double, 2, 2> t2;
    
    t1 = I;
    t1.noalias() -= A * a_inv * A.transpose();
    G11 = t1.inverse();
   
    t2 = a;
    t2.noalias() -= A.transpose() * I * A;
    G22 = t2.inverse();

    G12.noalias() = - G11 * A * a.inverse();
    
    cout << "G11: " << endl << G11 << endl;
    cout << "G12: " << endl << G12 << endl;
    cout << "G22: " << endl << G22 << endl;
    
    Matrix<double, 3, 3> G11_dr;
    Matrix<double, 3, 3> G11_dtheta;
    Matrix<double, 2, 2> G22_dr;
    Matrix<double, 2, 2> G22_dtheta;
    Matrix<double, 3, 2> G12_dr;
    Matrix<double, 3, 2> G12_dtheta;
    

    // derivatives dH/dr and dH/dtheta
    G11_dr = - G11 * I_dr * G11;
    G11_dtheta = - G11 * I_dtheta * G11;

    G22_dr = - G22 * A.transpose() * I_inv * I_dr * I_inv * A * G22;
    G22_dtheta = - G22 * A.transpose() * I_inv * I_dtheta * I_inv * A * G22;

    G12_dr = - G11_dr * A * a_inv;
    G12_dtheta = -G11_dtheta * A * a_inv;

    double ang_term, kin_term, cor_term;

    ang_term = 0.5 * j_vector.transpose() * G11_dr * j_vector;
    kin_term = 0.5 * p_vector.transpose() * G22_dr * p_vector;
    cor_term = j_vector.transpose() * G12_dr * p_vector;

    double h_dr = ang_term + kin_term + cor_term;
    printf("ang_term: %lf; kin_term: %lf; cor_term: %lf\n", ang_term, kin_term, cor_term);
    printf("dh dr: %lf\n", h_dr);

    ang_term = 0.5 * j_vector.transpose() * G11_dtheta * j_vector;
    kin_term = 0.5 * p_vector.transpose() * G22_dtheta * p_vector;
    cor_term = j_vector.transpose() * G12_dtheta * p_vector;

    double h_dtheta = ang_term + kin_term + cor_term;

    // (vector of) derivatives dH/dp
    Vector2d h_dp = G22 * p_vector + G12.transpose() * j_vector;
       
    // derivatives dH/dalpha, dH/dbeta
    ang_term = j_vector.transpose() * G11 * j_vector_dalpha;
    cor_term = j_vector_dalpha.transpose() * G12 * p_vector;

    ang_term = j_vector.transpose() * G11 * j_vector_dbeta;
    cor_term = j_vector_dbeta.transpose() * G12 * p_vector;
    // kinetic term is independent of alpha,beta
    
    double h_dalpha = ang_term + cor_term;
    double h_dbeta = ang_term + cor_term;
    
    out[0] = h_dr;
    out[1] = h_dtheta;
    out[2] = h_dp(0);
    out[3] = h_dp(1);
    out[4] = h_dalpha;
    out[5] = h_dbeta;
}

double* legendre_array(int N, double cosT)
{
    double* leg = (double*) malloc ((N+1) * sizeof(double));
    leg[0] = 1;
    leg[1] = cosT;

    for ( int i = 1; i < N; ++i ) {
        leg[i + 1] = ((2.0 * i + 1.0) / (i + 1.0) * cosT * leg[i] - ((double) i/(i + 1.0)) * leg[i-1]);
    }
    return leg;
}

double derivativeTheta(double R, double Theta)
{	
	double t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15, t16, t17, t18, t19, 
	t20, t21, t22, t27, t28, t29, t32, t36, t37, t38, t39, t40, t41, t42, t43, t44, t45, t46, t47, t79, t82, t86; 

	double cosT = cos(Theta);
	double sinT = sin(Theta);

	double *legP = legendre_array(10,cosT);

	if (R<4.500000)
	{
	t2 = exp(-0.13910571666810e1 * R);
t3 = t2 * cosT;
t8 = exp(-0.11314491915437e1 * R);
t15 = exp(-0.63429130737700e0 * R);
t22 = exp(0.49580080306684e-1 * R);
t29 = exp(-0.10290558301028e-1 * R);
t37 = cosT * cosT;
t86 = -0.40000000000000e-9 * sinT * (-0.24321463482684e18 * t3 + 0.24321463482684e18 * t3 * legP[2] - 0.74492214522290e17 * t8 * legP[3] + 0.74492214522290e17 * t8 * cosT * legP[4] - 0.32734349504058e16 * t15 * legP[5] + 0.32734349504058e16 * t15 * cosT * legP[6] - 0.40218973881620e14 * t22 * legP[7] + 0.40218973881620e14 * t22 * cosT * legP[8] - 0.15203232115809e14 * t29 * legP[9] + 0.15203232115809e14 * t29 * cosT * legP[10]) / (t37 - 0.1e1);

	}
	else if (R<4.750000)
	{
	t1 = cosT * R;
	t4 = R * R;
	t5 = cosT * t4;
	t8 = t4 * R;
	t9 = cosT * t8;
	t43 = 0.13174257127859e31 * t1 * legP[2] - 0.26638341296475e30 * t5 * legP[2] + 0.18204052805975e29 * t9 * legP[2] + 0.17149744352031e31 * t1 * legP[4] - 0.35946231573586e30 * t5 * legP[4] + 0.25364868902987e29 * t9 * legP[4] + 0.22115941390564e31 * cosT - 0.22115941390564e31 * cosT * legP[2] - 0.27679678308680e31 * cosT * legP[4] - 0.20680025418292e31 * cosT * legP[6] - 0.11197684986661e31 * cosT * legP[8] - 0.23117962056184e30 * cosT * legP[10] + 0.26638341296475e30 * t5 - 0.18204052805975e29 * t9 - 0.17149744352031e31 * R * legP[3] + 0.35946231573586e30 * t4 * legP[3] - 0.25364868902987e29 * t8 * legP[3] - 0.13340879604305e31 * R * legP[5] + 0.28873746890246e30 * t4 * legP[5] - 0.20894365548312e29 * t8 * legP[5];
	t79 = -0.73228212768511e30 * R * legP[7] + 0.15984284693455e30 * t4 * legP[7] - 0.11624753827772e29 * t8 * legP[7] - 0.15102384289339e30 * R * legP[9] + 0.32960219368772e29 * t4 * legP[9] - 0.23971046293147e28 * t8 * legP[9] - 0.28873746890246e30 * t5 * legP[6] + 0.20894365548312e29 * t9 * legP[6] + 0.73228212768511e30 * t1 * legP[8] - 0.15984284693455e30 * t5 * legP[8] + 0.11624753827772e29 * t9 * legP[8] + 0.15102384289339e30 * t1 * legP[10] - 0.32960219368772e29 * t5 * legP[10] + 0.23971046293147e28 * t9 * legP[10] + 0.27679678308680e31 * legP[3] + 0.20680025418292e31 * legP[5] + 0.11197684986661e31 * legP[7] + 0.23117962056184e30 * legP[9] - 0.13174257127859e31 * t1 + 0.13340879604305e31 * t1 * legP[6];
	t82 = cosT * cosT;
	t86 = 0.10000000000000e-22 * sinT * (t43 + t79) / (t82 - 0.1e1);
	}
	else if (R<5.000000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.58597793875722e29 * cosT - 0.58597793875722e29 * cosT * legP[2] - 0.38995099806608e30 * cosT * legP[4] - 0.46100920649859e30 * cosT * legP[6] - 0.22917893769780e30 * cosT * legP[8] - 0.28398771947907e29 * cosT * legP[10] - 0.56851779365510e29 * t12 + 0.14711137824495e29 * t15 - 0.11547405575015e28 * t18 - 0.25458878432540e30 * R * legP[3] + 0.53993872250494e29 * t14 * legP[3] - 0.37541828573731e28 * t17 * legP[3] - 0.28416843639083e30 * R * legP[5] + 0.57855722563534e29 * t14 * legP[5] - 0.39020289490025e28 * t17 * legP[5] - 0.13847961272988e30 * R * legP[7] + 0.27734055561343e29 * t14 * legP[7] - 0.18443215286697e28 * t17 * legP[7] - 0.16682151121937e29 * R * legP[9] + 0.32206002831298e28 * t14 * legP[9];
	t79 = -0.20498034269399e27 * t17 * legP[9] + 0.11547405575015e28 * t18 * legP[2] + 0.56851779365510e29 * t12 * legP[2] - 0.14711137824495e29 * t15 * legP[2] + 0.25458878432540e30 * t12 * legP[4] - 0.53993872250494e29 * t15 * legP[4] + 0.37541828573731e28 * t18 * legP[4] + 0.28416843639083e30 * t12 * legP[6] - 0.57855722563534e29 * t15 * legP[6] + 0.39020289490025e28 * t18 * legP[6] + 0.13847961272988e30 * t12 * legP[8] - 0.27734055561343e29 * t15 * legP[8] + 0.18443215286697e28 * t18 * legP[8] + 0.16682151121937e29 * t12 * legP[10] - 0.32206002831298e28 * t15 * legP[10] + 0.20498034269399e27 * t18 * legP[10] + 0.38995099806608e30 * legP[3] + 0.46100920649859e30 * legP[5] + 0.22917893769780e30 * legP[7] + 0.28398771947907e29 * legP[9];
	t82 = cosT * cosT;
	t86 = -0.40000000000000e-22 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<5.250000)
	{
	t16 = cosT * R;
	t18 = R * R;
	t19 = cosT * t18;
	t21 = t18 * R;
	t22 = cosT * t21;
	t38 = 0.30296530047165e31 * legP[3] + 0.16678799781344e29 * legP[5] - 0.11508718987106e31 * legP[7] - 0.96854175346304e30 * legP[9] + 0.41230152545009e31 * cosT - 0.41230152545009e31 * cosT * legP[2] - 0.30296530047165e31 * cosT * legP[4] - 0.16678799781344e29 * cosT * legP[6] + 0.11508718987106e31 * cosT * legP[8] + 0.96854175346304e30 * cosT * legP[10] - 0.20399470918990e31 * t16 + 0.34117377935192e30 * t19 - 0.19264957906092e29 * t22 - 0.14054280931152e31 * R * legP[3] + 0.21956331091473e30 * t18 * legP[3] - 0.11545726580845e29 * t21 * legP[3] + 0.14125096996465e30 * R * legP[5] - 0.48690899700322e29 * t18 * legP[5] + 0.41456755420269e28 * t21 * legP[5] + 0.70996814145022e30 * R * legP[7];
	t79 = -0.14275628859740e30 * t18 * legP[7] + 0.94247757314290e28 * t21 * legP[7] + 0.57398281114169e30 * R * legP[9] - 0.11247996340319e30 * t18 * legP[9] + 0.73041373699191e28 * t21 * legP[9] - 0.41456755420269e28 * t22 * legP[6] + 0.20399470918990e31 * t16 * legP[2] - 0.34117377935192e30 * t19 * legP[2] + 0.19264957906092e29 * t22 * legP[2] + 0.14054280931152e31 * t16 * legP[4] - 0.21956331091473e30 * t19 * legP[4] + 0.11545726580845e29 * t22 * legP[4] - 0.14125096996465e30 * t16 * legP[6] + 0.48690899700322e29 * t19 * legP[6] - 0.70996814145022e30 * t16 * legP[8] + 0.14275628859740e30 * t19 * legP[8] - 0.94247757314290e28 * t22 * legP[8] - 0.57398281114169e30 * t16 * legP[10] + 0.11247996340319e30 * t19 * legP[10] - 0.73041373699191e28 * t22 * legP[10];
	t82 = cosT * cosT;
	t86 = 0.20000000000000e-23 * sinT * (t38 + t79) / (t82 - 0.1e1);
	}
	else if (R<5.500000)
	{
	t1 = cosT * R;
	t4 = R * R;
	t5 = cosT * t4;
	t8 = t4 * R;
	t9 = cosT * t8;
	t45 = 0.14872226198823e32 * t1 * legP[2] - 0.23589292753924e31 * t5 * legP[2] + 0.12580459378303e30 * t9 * legP[2] + 0.12001132193074e32 * t1 * legP[4] - 0.18045571590374e31 * t5 * legP[4] + 0.90627046753850e29 * t9 * legP[4] + 0.29083359903367e31 * t1 * legP[6] - 0.33610922966025e30 * t5 * legP[6] + 0.10798370082174e29 * t9 * legP[6] + 0.61312764703737e30 * t1 * legP[8] - 0.41543601938268e29 * t5 * legP[8] - 0.97115490715842e27 * t9 * legP[8] + 0.11519864314401e31 * t1 * legP[10] - 0.18792694555995e30 * t5 * legP[10] + 0.10306345639973e29 * t9 * legP[10] + 0.31557474284718e32 * cosT - 0.31557474284718e32 * cosT * legP[2] - 0.26703519755531e32 * cosT * legP[4] - 0.77282679552839e31 * cosT * legP[6] - 0.19886968705881e31 * cosT * legP[8];
	t79 = -0.23752579153692e31 * cosT * legP[10] - 0.14872226198823e32 * t1 + 0.23589292753924e31 * t5 - 0.12580459378303e30 * t9 - 0.12001132193074e32 * R * legP[3] + 0.18045571590374e31 * t4 * legP[3] - 0.90627046753850e29 * t8 * legP[3] - 0.29083359903367e31 * R * legP[5] + 0.33610922966025e30 * t4 * legP[5] - 0.10798370082174e29 * t8 * legP[5] - 0.61312764703737e30 * R * legP[7] + 0.41543601938268e29 * t4 * legP[7] + 0.97115490715842e27 * t8 * legP[7] - 0.11519864314401e31 * R * legP[9] + 0.18792694555995e30 * t4 * legP[9] - 0.10306345639973e29 * t8 * legP[9] + 0.26703519755531e32 * legP[3] + 0.77282679552839e31 * legP[5] + 0.19886968705881e31 * legP[7] + 0.23752579153692e31 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.20000000000000e-24 * sinT * (t45 + t79) / (t82 - 0.1e1);
	}
	else if (R<5.750000)
	{
	t16 = cosT * R;
	t18 = R * R;
	t19 = cosT * t18;
	t21 = t18 * R;
	t22 = cosT * t21;
	t38 = 0.33273231722016e31 * legP[3] + 0.16577896055244e31 * legP[5] + 0.57867083897535e30 * legP[7] + 0.16886088794479e30 * legP[9] + 0.30992754717798e31 * cosT - 0.30992754717798e31 * cosT * legP[2] - 0.33273231722016e31 * cosT * legP[4] - 0.16577896055244e31 * cosT * legP[6] - 0.57867083897535e30 * cosT * legP[8] - 0.16886088794479e30 * cosT * legP[10] - 0.14564197344140e31 * t16 + 0.23029240290863e30 * t19 - 0.12241033643114e29 * t22 - 0.15584611447521e31 * R * legP[3] + 0.24560988416641e30 * t18 * legP[3] - 0.13011442145850e29 * t21 * legP[3] - 0.77354058630420e30 * R * legP[5] + 0.12137582974248e30 * t18 * legP[5] - 0.63989222673966e28 * t21 * legP[5] - 0.26847702938550e30 * R * legP[7];
	t79 = 0.41820590135965e29 * t18 * legP[7] - 0.21856863239592e28 * t21 * legP[7] - 0.77745059366485e29 * R * legP[9] + 0.11982952050990e29 * t18 * legP[9] - 0.61792289702724e27 * t21 * legP[9] + 0.14564197344140e31 * t16 * legP[2] - 0.23029240290863e30 * t19 * legP[2] + 0.12241033643114e29 * t22 * legP[2] + 0.15584611447521e31 * t16 * legP[4] - 0.24560988416641e30 * t19 * legP[4] + 0.13011442145850e29 * t22 * legP[4] + 0.77354058630420e30 * t16 * legP[6] - 0.12137582974248e30 * t19 * legP[6] + 0.63989222673966e28 * t22 * legP[6] + 0.26847702938550e30 * t16 * legP[8] - 0.41820590135965e29 * t19 * legP[8] + 0.21856863239592e28 * t22 * legP[8] + 0.77745059366485e29 * t16 * legP[10] - 0.11982952050990e29 * t19 * legP[10] + 0.61792289702724e27 * t22 * legP[10];
	t82 = cosT * cosT;
	t86 = 0.20000000000000e-23 * sinT * (t38 + t79) / (t82 - 0.1e1);
	}
	else if (R<6.000000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.11927682596023e31 * cosT - 0.11927682596023e31 * cosT * legP[2] - 0.13105295736197e31 * cosT * legP[4] - 0.68289844422314e30 * cosT * legP[6] - 0.26607767157645e30 * cosT * legP[8] - 0.94711583767755e29 * cosT * legP[10] - 0.54201709696999e30 * t12 + 0.82764850108748e29 * t15 - 0.42433370334084e28 * t18 - 0.59498778325552e30 * R * legP[3] + 0.90762717888324e29 * t14 * legP[3] - 0.46482008297436e28 * t17 * legP[3] - 0.31059828000128e30 * R * legP[5] + 0.47440608236316e29 * t14 * legP[5] - 0.24315013287752e28 * t17 * legP[5] - 0.12210403752167e30 * R * legP[7] + 0.18799951212143e29 * t14 * legP[7] - 0.97050438772802e27 * t17 * legP[7] - 0.44236602619954e29 * R * legP[9] + 0.69243582753578e28 * t14 * legP[9];
	t79 = -0.36304157894046e27 * t17 * legP[9] - 0.69243582753578e28 * t15 * legP[10] + 0.54201709696999e30 * t12 * legP[2] - 0.82764850108748e29 * t15 * legP[2] + 0.42433370334084e28 * t18 * legP[2] + 0.59498778325552e30 * t12 * legP[4] - 0.90762717888324e29 * t15 * legP[4] + 0.46482008297436e28 * t18 * legP[4] + 0.31059828000128e30 * t12 * legP[6] - 0.47440608236316e29 * t15 * legP[6] + 0.24315013287752e28 * t18 * legP[6] + 0.12210403752167e30 * t12 * legP[8] - 0.18799951212143e29 * t15 * legP[8] + 0.97050438772802e27 * t18 * legP[8] + 0.44236602619954e29 * t12 * legP[10] + 0.36304157894046e27 * t18 * legP[10] + 0.13105295736197e31 * legP[3] + 0.68289844422314e30 * legP[5] + 0.26607767157645e30 * legP[7] + 0.94711583767755e29 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.40000000000000e-23 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<6.250000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.18449542347862e31 * cosT - 0.18449542347862e31 * cosT * legP[2] - 0.20669991725963e31 * cosT * legP[4] - 0.10952248631169e31 * cosT * legP[6] - 0.41363176328395e30 * cosT * legP[8] - 0.12558568238678e30 * cosT * legP[10] - 0.81374305173082e30 * t12 + 0.12048117651597e30 * t15 - 0.59839783056209e28 * t18 - 0.91294557918945e30 * R * legP[3] + 0.13535377122305e30 * t14 * legP[3] - 0.67313091842875e28 * t17 * legP[3] - 0.48591054733789e30 * R * legP[5] + 0.72333547695190e29 * t14 * legP[5] - 0.36103543921368e28 * t17 * legP[5] - 0.18494628510887e30 * R * legP[7] + 0.27722937435207e29 * t14 * legP[7] - 0.13922884982850e28 * t17 * legP[7] - 0.56554462665543e29 * R * legP[9] + 0.85289261216547e28 * t14 * legP[9];
	t79 = -0.43053924515531e27 * t17 * legP[9] + 0.13922884982850e28 * t18 * legP[8] + 0.91294557918945e30 * t12 * legP[4] + 0.67313091842875e28 * t18 * legP[4] + 0.18494628510887e30 * t12 * legP[8] + 0.81374305173082e30 * t12 * legP[2] - 0.12048117651597e30 * t15 * legP[2] + 0.59839783056209e28 * t18 * legP[2] - 0.13535377122305e30 * t15 * legP[4] + 0.48591054733789e30 * t12 * legP[6] - 0.72333547695190e29 * t15 * legP[6] + 0.36103543921368e28 * t18 * legP[6] - 0.27722937435207e29 * t15 * legP[8] + 0.56554462665543e29 * t12 * legP[10] - 0.85289261216547e28 * t15 * legP[10] + 0.43053924515531e27 * t18 * legP[10] + 0.20669991725963e31 * legP[3] + 0.10952248631169e31 * legP[5] + 0.41363176328395e30 * legP[7] + 0.12558568238678e30 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.20000000000000e-23 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<6.500000)
	{
	t1 = R * R;
	t2 = t1 * R;
	t3 = t2 * cosT;
	t6 = cosT * R;
	t9 = cosT * t1;
	t41 = 0.11671588876090e29 * t3 * legP[6] + 0.28887299136815e31 * t6 * legP[2] - 0.41360822738424e30 * t9 * legP[2] + 0.19850683251005e29 * t3 * legP[2] + 0.32207975280114e31 * t6 * legP[4] - 0.46173999724556e30 * t9 * legP[4] + 0.22188340115053e29 * t3 * legP[4] + 0.16818750314636e31 * t6 * legP[6] - 0.24203930563981e30 * t9 * legP[6] + 0.62407444406189e30 * t6 * legP[8] - 0.90509570138837e29 * t9 * legP[8] + 0.43958362494413e28 * t3 * legP[8] + 0.19369488380397e30 * t6 * legP[10] - 0.28392241884475e29 * t9 * legP[10] + 0.13925688271740e28 * t3 * legP[10] + 0.75351409297823e31 * legP[3] + 0.39184624296974e31 * legP[5] + 0.14417901049980e31 * legP[7] + 0.44235043375946e30 * legP[9] + 0.67664683719049e31 * cosT;
	t79 = -0.67664683719049e31 * cosT * legP[2] - 0.75351409297823e31 * cosT * legP[4] - 0.39184624296974e31 * cosT * legP[6] - 0.14417901049980e31 * cosT * legP[8] - 0.44235043375946e30 * cosT * legP[10] - 0.28887299136815e31 * t6 + 0.41360822738424e30 * t9 - 0.19850683251005e29 * t3 - 0.32207975280114e31 * R * legP[3] + 0.46173999724556e30 * t1 * legP[3] - 0.22188340115053e29 * t2 * legP[3] - 0.16818750314636e31 * R * legP[5] + 0.24203930563981e30 * t1 * legP[5] - 0.11671588876090e29 * t2 * legP[5] - 0.62407444406189e30 * R * legP[7] + 0.90509570138837e29 * t1 * legP[7] - 0.43958362494413e28 * t2 * legP[7] - 0.19369488380397e30 * R * legP[9] + 0.28392241884475e29 * t1 * legP[9] - 0.13925688271740e28 * t2 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.40000000000000e-24 * sinT * (t41 + t79) / (t82 - 0.1e1);
	}
	else if (R<6.750000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.19585686537139e32 * cosT - 0.19585686537139e32 * cosT * legP[2] - 0.21655594352854e32 * cosT * legP[4] - 0.10992505194259e32 * cosT * legP[6] - 0.37942313908142e31 * cosT * legP[8] - 0.10367695988582e31 * cosT * legP[10] - 0.81025256775810e31 * t12 + 0.11232953745916e31 * t15 - 0.52164910699131e29 * t18 - 0.89670504045347e31 * R * legP[3] + 0.12444769570574e31 * t14 * legP[3] - 0.57856794720474e29 * t17 * legP[3] - 0.45668795760712e31 * R * legP[5] + 0.63575406105413e30 * t14 * legP[5] - 0.29640039529739e29 * t17 * legP[5] - 0.15857151473963e31 * R * legP[7] + 0.22194864534748e30 * t14 * legP[7] - 0.10399261140951e29 * t17 * legP[7] - 0.43664162620988e30 * R * legP[9] + 0.61547750767745e29 * t14 * legP[9];
	t79 = -0.29025206025339e28 * t17 * legP[9] - 0.22194864534748e30 * t15 * legP[8] + 0.81025256775810e31 * t12 * legP[2] - 0.11232953745916e31 * t15 * legP[2] + 0.52164910699131e29 * t18 * legP[2] + 0.89670504045347e31 * t12 * legP[4] - 0.12444769570574e31 * t15 * legP[4] + 0.57856794720474e29 * t18 * legP[4] + 0.45668795760712e31 * t12 * legP[6] - 0.63575406105413e30 * t15 * legP[6] + 0.29640039529739e29 * t18 * legP[6] + 0.15857151473963e31 * t12 * legP[8] + 0.10399261140951e29 * t18 * legP[8] + 0.43664162620988e30 * t12 * legP[10] - 0.61547750767745e29 * t15 * legP[10] + 0.29025206025339e28 * t18 * legP[10] + 0.21655594352854e32 * legP[3] + 0.10992505194259e32 * legP[5] + 0.37942313908142e31 * legP[7] + 0.10367695988582e31 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.10000000000000e-24 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<7.000000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.34709991546275e31 * cosT - 0.34709991546275e31 * cosT * legP[2] - 0.38043259681779e31 * cosT * legP[4] - 0.18901923165103e31 * cosT * legP[6] - 0.62134067546275e30 * cosT * legP[8] - 0.15700748365341e30 * cosT * legP[10] - 0.13921103173253e31 * t12 + 0.18696886556347e30 * t15 - 0.84064139422176e28 * t18 - 0.15263969922289e31 * R * legP[3] + 0.20513914905623e30 * t14 * legP[3] - 0.92306139784835e28 * t17 * legP[3] - 0.76041590199361e30 * R * legP[5] + 0.10244903496365e30 * t14 * legP[5] - 0.46204059170086e28 * t17 * legP[5] - 0.25099893251982e30 * R * legP[7] + 0.33941997732537e29 * t14 * legP[7] - 0.15358565887275e28 * t17 * legP[7] - 0.63744888303080e29 * R * legP[9] + 0.86587127661007e28 * t14 * legP[9];
	t79 = -0.39337212960455e27 * t17 * legP[9] + 0.13921103173253e31 * t12 * legP[2] - 0.18696886556347e30 * t15 * legP[2] + 0.84064139422176e28 * t18 * legP[2] + 0.15263969922289e31 * t12 * legP[4] - 0.20513914905623e30 * t15 * legP[4] + 0.92306139784835e28 * t18 * legP[4] + 0.76041590199361e30 * t12 * legP[6] - 0.10244903496365e30 * t15 * legP[6] + 0.46204059170086e28 * t18 * legP[6] + 0.25099893251982e30 * t12 * legP[8] - 0.33941997732537e29 * t15 * legP[8] + 0.15358565887275e28 * t18 * legP[8] + 0.63744888303080e29 * t12 * legP[10] - 0.86587127661007e28 * t15 * legP[10] + 0.39337212960455e27 * t18 * legP[10] + 0.38043259681779e31 * legP[3] + 0.18901923165103e31 * legP[5] + 0.62134067546275e30 * legP[7] + 0.15700748365341e30 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.40000000000000e-24 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<7.250000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.97018855901352e31 * cosT - 0.97018855901352e31 * cosT * legP[2] - 0.10556722999650e32 * cosT * legP[4] - 0.51632332495415e31 * cosT * legP[6] - 0.16546629656476e31 * cosT * legP[8] - 0.39993548477133e30 * cosT * legP[10] - 0.37761079714266e31 * t12 + 0.49182784827174e30 * t15 - 0.21432912245913e29 * t18 - 0.41081961661747e31 * R * legP[3] + 0.53521491011906e30 * t14 * legP[3] - 0.23334756575559e29 * t17 * legP[3] - 0.20141481723317e31 * R * legP[5] + 0.26300822047709e30 * t14 * legP[5] - 0.11491722745295e29 * t17 * legP[5] - 0.64798155742068e30 * R * legP[7] + 0.84908823407491e29 * t14 * legP[7] - 0.37215612347832e28 * t17 * legP[7] - 0.15722478899418e30 * R * legP[9] + 0.20669884747525e29 * t14 * legP[9];
	t79 = -0.90849012237643e27 * t17 * legP[9] + 0.37761079714266e31 * t12 * legP[2] - 0.49182784827174e30 * t15 * legP[2] + 0.21432912245913e29 * t18 * legP[2] + 0.41081961661747e31 * t12 * legP[4] - 0.53521491011906e30 * t15 * legP[4] + 0.23334756575559e29 * t18 * legP[4] + 0.20141481723317e31 * t12 * legP[6] - 0.26300822047709e30 * t15 * legP[6] + 0.11491722745295e29 * t18 * legP[6] + 0.64798155742068e30 * t12 * legP[8] - 0.84908823407491e29 * t15 * legP[8] + 0.37215612347832e28 * t18 * legP[8] + 0.15722478899418e30 * t12 * legP[10] - 0.20669884747525e29 * t15 * legP[10] + 0.90849012237643e27 * t18 * legP[10] + 0.10556722999650e32 * legP[3] + 0.51632332495415e31 * legP[5] + 0.16546629656476e31 * legP[7] + 0.39993548477133e30 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.10000000000000e-24 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<7.500000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.66697325548773e31 * cosT - 0.66697325548773e31 * cosT * legP[2] - 0.72052098907634e31 * cosT * legP[4] - 0.34649661870457e31 * cosT * legP[6] - 0.10867929728888e31 * cosT * legP[8] - 0.26020166448580e30 * cosT * legP[10] - 0.25214239568370e31 * t12 + 0.31876798419043e30 * t15 - 0.13476136885853e29 * t18 - 0.27213631556011e31 * R * legP[3] + 0.34392759831581e30 * t14 * legP[3] - 0.14539937642077e29 * t17 * legP[3] - 0.13114169740576e31 * R * legP[5] + 0.16607977933583e30 * t14 * legP[5] - 0.70352426928230e28 * t17 * legP[5] - 0.41300087076187e30 * R * legP[7] + 0.52497694213171e29 * t14 * legP[7] - 0.22313943752744e28 * t17 * legP[7] - 0.99403897841554e29 * R * legP[9] + 0.12694589416128e29 * t14 * legP[9];
	t79 = -0.54180987725473e27 * t17 * legP[9] + 0.54180987725473e27 * t18 * legP[10] + 0.27213631556011e31 * t12 * legP[4] + 0.25214239568370e31 * t12 * legP[2] - 0.31876798419043e30 * t15 * legP[2] + 0.13476136885853e29 * t18 * legP[2] - 0.34392759831581e30 * t15 * legP[4] + 0.14539937642077e29 * t18 * legP[4] + 0.13114169740576e31 * t12 * legP[6] - 0.16607977933583e30 * t15 * legP[6] + 0.70352426928230e28 * t18 * legP[6] + 0.41300087076187e30 * t12 * legP[8] - 0.52497694213171e29 * t15 * legP[8] + 0.22313943752744e28 * t18 * legP[8] + 0.99403897841554e29 * t12 * legP[10] - 0.12694589416128e29 * t15 * legP[10] + 0.72052098907634e31 * legP[3] + 0.34649661870457e31 * legP[5] + 0.10867929728888e31 * legP[7] + 0.26020166448580e30 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.10000000000000e-24 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<7.750000)
	{
	t5 = cosT * R;
	t8 = R * R;
	t9 = t8 * cosT;
	t16 = t8 * R;
	t17 = t16 * cosT;
	t41 = 0.13963297504397e31 * legP[7] + 0.32738342176490e30 * legP[9] + 0.96968811834797e31 * legP[3] + 0.45722520577008e31 * legP[5] + 0.12159983280042e30 * t5 * legP[10] - 0.15094783781232e29 * t9 * legP[10] + 0.51509926338862e30 * t5 * legP[8] - 0.63541724674993e29 * t9 * legP[8] + 0.26204036949332e28 * t17 * legP[8] - 0.40780239668063e30 * t9 * legP[2] + 0.62609108557506e27 * t17 * legP[10] + 0.33198461259221e31 * t5 * legP[2] + 0.16741892807251e29 * t17 * legP[2] + 0.35573108719834e31 * t5 * legP[4] - 0.43646647140244e30 * t9 * legP[4] + 0.17907043051746e29 * t17 * legP[4] + 0.16797618215589e31 * t5 * legP[6] - 0.20641660846416e30 * t9 * legP[6] + 0.84819098208681e28 * t17 * legP[6] - 0.16741892807251e29 * t17;
	t79 = -0.35573108719834e31 * R * legP[3] + 0.43646647140244e30 * t8 * legP[3] - 0.17907043051746e29 * t16 * legP[3] - 0.16797618215589e31 * R * legP[5] + 0.20641660846416e30 * t8 * legP[5] - 0.84819098208681e28 * t16 * legP[5] - 0.51509926338862e30 * R * legP[7] + 0.63541724674993e29 * t8 * legP[7] - 0.26204036949332e28 * t16 * legP[7] - 0.12159983280042e30 * R * legP[9] + 0.15094783781232e29 * t8 * legP[9] - 0.62609108557506e27 * t16 * legP[9] - 0.90319606403744e31 * cosT * legP[2] - 0.96968811834797e31 * cosT * legP[4] - 0.45722520577008e31 * cosT * legP[6] - 0.13963297504397e31 * cosT * legP[8] - 0.32738342176490e30 * cosT * legP[10] - 0.33198461259221e31 * t5 + 0.40780239668063e30 * t9 + 0.90319606403744e31 * cosT;
	t82 = cosT * cosT;
	t86 = 0.50000000000000e-25 * sinT * (t41 + t79) / (t82 - 0.1e1);
	}
	else if (R<8.000000)
	{
	t5 = R * R;
	t6 = t5 * R;
	t7 = t6 * cosT;
	t10 = cosT * R;
	t13 = t5 * cosT;
	t41 = 0.95791859120856e30 * legP[9] + 0.14930885129371e32 * legP[5] + 0.43763455054143e31 * legP[7] + 0.32227391163169e32 * legP[3] + 0.54610273354440e29 * t7 * legP[4] + 0.53289864655498e31 * t10 * legP[6] - 0.63597689493437e30 * t13 * legP[6] + 0.25372725560837e29 * t7 * legP[6] + 0.15669918343169e31 * t10 * legP[8] - 0.18757901271352e30 * t13 * legP[8] + 0.75050459730984e28 * t7 * legP[8] + 0.34516102815081e30 * t10 * legP[10] - 0.41559320731795e29 * t13 * legP[10] + 0.10773700359513e32 * t10 * legP[2] - 0.12873306582293e31 * t13 * legP[2] + 0.16717630332790e28 * t7 * legP[10] + 0.51379084458880e29 * t7 * legP[2] + 0.11493516390537e32 * t10 * legP[4] - 0.13703274577375e31 * t13 * legP[4] + 0.30110516670788e32 * cosT;
	t79 = -0.30110516670788e32 * cosT * legP[2] - 0.32227391163169e32 * cosT * legP[4] - 0.14930885129371e32 * cosT * legP[6] - 0.43763455054143e31 * cosT * legP[8] - 0.95791859120856e30 * cosT * legP[10] - 0.10773700359513e32 * t10 + 0.12873306582293e31 * t13 - 0.51379084458880e29 * t7 - 0.11493516390537e32 * R * legP[3] + 0.13703274577375e31 * t5 * legP[3] - 0.54610273354440e29 * t6 * legP[3] - 0.53289864655498e31 * R * legP[5] + 0.63597689493437e30 * t5 * legP[5] - 0.25372725560837e29 * t6 * legP[5] - 0.15669918343169e31 * R * legP[7] + 0.18757901271352e30 * t5 * legP[7] - 0.75050459730984e28 * t6 * legP[7] - 0.34516102815081e30 * R * legP[9] + 0.41559320731795e29 * t5 * legP[9] - 0.16717630332790e28 * t6 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.10000000000000e-25 * sinT * (t41 + t79) / (t82 - 0.1e1);
	}
	else if (R<8.250000)
	{
	t16 = cosT * R;
	t18 = R * R;
	t19 = cosT * t18;
	t21 = t18 * R;
	t22 = cosT * t21;
	t38 = 0.21168619550048e32 * legP[3] + 0.96235600440847e31 * legP[5] + 0.27219212411927e31 * legP[7] + 0.54891505470453e30 * legP[9] + 0.19745639870595e32 * cosT - 0.19745639870595e32 * cosT * legP[2] - 0.21168619550048e32 * cosT * legP[4] - 0.96235600440847e31 * cosT * legP[6] - 0.27219212411927e31 * cosT * legP[8] - 0.54891505470453e30 * cosT * legP[10] - 0.68868715594407e31 * t16 + 0.80147705822023e30 * t19 - 0.31135184458505e29 * t22 - 0.73464770356172e31 * R * legP[3] + 0.85194753837242e30 * t18 * legP[3] - 0.33011110047564e29 * t21 * legP[3] - 0.33387395585673e31 * R * legP[5] + 0.38719603156157e30 * t18 * legP[5] - 0.15006856253638e29 * t21 * legP[5] - 0.94658273523385e30 * R * legP[7];
	t79 = 0.11002787532813e30 * t18 * legP[7] - 0.42737485820409e28 * t21 * legP[7] - 0.19178470196180e30 * R * legP[9] + 0.22387279958169e29 * t18 * legP[9] - 0.87292800104453e27 * t21 * legP[9] + 0.19178470196180e30 * t16 * legP[10] + 0.68868715594407e31 * t16 * legP[2] - 0.80147705822023e30 * t19 * legP[2] + 0.31135184458505e29 * t22 * legP[2] + 0.73464770356172e31 * t16 * legP[4] - 0.85194753837242e30 * t19 * legP[4] + 0.33011110047564e29 * t22 * legP[4] + 0.33387395585673e31 * t16 * legP[6] - 0.38719603156157e30 * t19 * legP[6] + 0.15006856253638e29 * t22 * legP[6] + 0.94658273523385e30 * t16 * legP[8] - 0.11002787532813e30 * t19 * legP[8] + 0.42737485820409e28 * t22 * legP[8] - 0.22387279958169e29 * t19 * legP[10] + 0.87292800104453e27 * t22 * legP[10];
	t82 = cosT * cosT;
	t86 = 0.10000000000000e-25 * sinT * (t38 + t79) / (t82 - 0.1e1);
	}
	else if (R<8.500000)
	{
	t16 = cosT * R;
	t18 = R * R;
	t19 = cosT * t18;
	t21 = t18 * R;
	t22 = cosT * t21;
	t38 = 0.13745630521893e32 * legP[3] + 0.62060263387537e31 * legP[5] + 0.17234854303665e31 * legP[7] + 0.33997671140635e30 * legP[9] + 0.12703064575107e32 * cosT - 0.12703064575107e32 * cosT * legP[2] - 0.13745630521893e32 * cosT * legP[4] - 0.62060263387537e31 * cosT * legP[6] - 0.17234854303665e31 * cosT * legP[8] - 0.33997671140635e30 * cosT * legP[10] - 0.43259350883539e31 * t16 + 0.49106051627036e30 * t19 - 0.18593101955479e29 * t22 - 0.46472082981062e31 * R * legP[3] + 0.52476344897719e30 * t18 * legP[3] - 0.19791550880077e29 * t21 * legP[3] - 0.20960000293561e31 * R * legP[5] + 0.23656093711172e30 * t18 * legP[5] - 0.89205898112197e28 * t21 * legP[5] - 0.58351516766069e30 * R * legP[7];
	t79 = 0.66019685319266e29 * t18 * legP[7] - 0.24956398948138e28 * t21 * legP[7] - 0.11580712258063e30 * R * legP[9] + 0.13177876396815e29 * t18 * legP[9] - 0.50083088745448e27 * t21 * legP[9] + 0.89205898112197e28 * t22 * legP[6] + 0.58351516766069e30 * t16 * legP[8] - 0.66019685319266e29 * t19 * legP[8] + 0.24956398948138e28 * t22 * legP[8] + 0.11580712258063e30 * t16 * legP[10] - 0.13177876396815e29 * t19 * legP[10] + 0.50083088745448e27 * t22 * legP[10] + 0.43259350883539e31 * t16 * legP[2] - 0.49106051627036e30 * t19 * legP[2] + 0.18593101955479e29 * t22 * legP[2] + 0.46472082981062e31 * t16 * legP[4] - 0.52476344897719e30 * t19 * legP[4] + 0.19791550880077e29 * t22 * legP[4] + 0.20960000293561e31 * t16 * legP[6] - 0.23656093711172e30 * t19 * legP[6];
	t82 = cosT * cosT;
	t86 = 0.10000000000000e-25 * sinT * (t38 + t79) / (t82 - 0.1e1);
	}
	else if (R<8.750000)
	{
	t16 = cosT * R;
	t18 = R * R;
	t19 = cosT * t18;
	t21 = t18 * R;
	t22 = cosT * t21;
	t38 = 0.21947245058738e32 * legP[3] + 0.98132827936795e31 * legP[5] + 0.25708915336759e31 * legP[7] + 0.52345034478282e30 * legP[9] + 0.19929248057372e32 * cosT - 0.19929248057372e32 * cosT * legP[2] - 0.21947245058738e32 * cosT * legP[4] - 0.98132827936795e31 * cosT * legP[6] - 0.25708915336759e31 * cosT * legP[8] - 0.52345034478282e30 * cosT * legP[10] - 0.66401035866276e31 * t16 + 0.73650609841032e30 * t19 - 0.27222159113577e29 * t22 - 0.72356097172675e31 * R * legP[3] + 0.79633085444321e30 * t18 * legP[3] - 0.29260141200203e29 * t21 * legP[3] - 0.32276060546121e31 * R * legP[5] + 0.35465010527599e30 * t18 * legP[5] - 0.13017073057331e29 * t21 * legP[5] - 0.84543896306690e30 * R * legP[7];
	t79 = 0.92890512582302e29 * t18 * legP[7] - 0.34093467677852e28 * t21 * legP[7] - 0.17428553572228e30 * R * legP[9] + 0.19387953259179e29 * t18 * legP[9] - 0.72044044479867e27 * t21 * legP[9] - 0.73650609841032e30 * t19 * legP[2] + 0.27222159113577e29 * t22 * legP[2] + 0.72356097172675e31 * t16 * legP[4] - 0.79633085444321e30 * t19 * legP[4] + 0.29260141200203e29 * t22 * legP[4] + 0.32276060546121e31 * t16 * legP[6] - 0.35465010527599e30 * t19 * legP[6] + 0.84543896306690e30 * t16 * legP[8] + 0.34093467677852e28 * t22 * legP[8] + 0.17428553572228e30 * t16 * legP[10] - 0.19387953259179e29 * t19 * legP[10] + 0.72044044479867e27 * t22 * legP[10] + 0.13017073057331e29 * t22 * legP[6] - 0.92890512582302e29 * t19 * legP[8] + 0.66401035866276e31 * t16 * legP[2];
	t82 = cosT * cosT;
	t86 = 0.40000000000000e-26 * sinT * (t38 + t79) / (t82 - 0.1e1);
	}
	else if (R<9.000000)
	{
	t5 = R * R;
	t6 = t5 * R;
	t7 = t6 * cosT;
	t10 = cosT * R;
	t13 = t5 * cosT;
	t41 = 0.27588384039338e32 * legP[3] + 0.12283125826839e32 * legP[5] + 0.33664456683974e31 * legP[7] + 0.31211343400517e30 * legP[9] + 0.15072510087296e29 * t7 * legP[6] + 0.79231864339338e31 * t10 * legP[2] - 0.86078125518389e30 * t13 * legP[2] + 0.31121234736231e29 * t7 * legP[2] + 0.88805544934591e31 * t10 * legP[4] - 0.95372857276345e30 * t13 * legP[4] + 0.34179972452864e29 * t7 * legP[4] + 0.39374613341889e31 * t10 * legP[6] - 0.42155726483365e30 * t13 * legP[6] + 0.10821908179209e31 * t10 * legP[8] - 0.11621678422598e30 * t13 * legP[8] + 0.41686272140991e28 * t7 * legP[8] + 0.96644012395254e29 * t10 * legP[10] - 0.99842426270097e28 * t13 * legP[10] + 0.34405559849830e27 * t7 * legP[10] - 0.79231864339338e31 * t10;
	t79 = 0.24233852291723e32 * cosT - 0.24233852291723e32 * cosT * legP[2] - 0.27588384039338e32 * cosT * legP[4] - 0.12283125826839e32 * cosT * legP[6] - 0.33664456683974e31 * cosT * legP[8] - 0.31211343400517e30 * cosT * legP[10] + 0.86078125518389e30 * t13 - 0.31121234736231e29 * t7 - 0.88805544934591e31 * R * legP[3] + 0.95372857276345e30 * t5 * legP[3] - 0.34179972452864e29 * t6 * legP[3] - 0.39374613341889e31 * R * legP[5] + 0.42155726483365e30 * t5 * legP[5] - 0.15072510087296e29 * t6 * legP[5] - 0.10821908179209e31 * R * legP[7] + 0.11621678422598e30 * t5 * legP[7] - 0.41686272140991e28 * t6 * legP[7] - 0.96644012395254e29 * R * legP[9] + 0.99842426270097e28 * t5 * legP[9] - 0.34405559849830e27 * t6 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.20000000000000e-26 * sinT * (t41 + t79) / (t82 - 0.1e1);
	}
	else if (R<9.250000)
	{
	t16 = R * R;
	t17 = t16 * R;
	t18 = cosT * t17;
	t38 = 0.84373865713169e31 * legP[3] + 0.38412697905036e31 * legP[5] + 0.91291122184101e30 * legP[7] + 0.23494687892880e30 * legP[9] + 0.70426743491497e31 * cosT - 0.70426743491497e31 * cosT * legP[2] - 0.84373865713169e31 * cosT * legP[4] - 0.38412697905036e31 * cosT * legP[6] - 0.91291122184101e30 * cosT * legP[8] - 0.23494687892880e30 * cosT * legP[10] - 0.86000524892237e28 * t18 - 0.26546754306122e31 * R * legP[3] + 0.27846408459090e30 * t16 * legP[3] - 0.97418306045498e28 * t17 * legP[3] - 0.12019662927891e31 * R * legP[5] + 0.12558259082734e30 * t16 * legP[5] - 0.43808460958895e28 * t17 * legP[5] - 0.28432487150786e30 * R * legP[7] + 0.29578332396039e29 * t16 * legP[7] - 0.10276447286439e28 * t17 * legP[7];
	t45 = cosT * R;
	t47 = t16 * cosT;
	t79 = -0.74618726839700e29 * R * legP[9] + 0.79139791626241e28 * t16 * legP[9] - 0.28024475662394e27 * t17 * legP[9] - 0.22701759513962e31 * t45 + 0.24245537586187e30 * t47 + 0.22701759513962e31 * t45 * legP[2] - 0.24245537586187e30 * t47 * legP[2] + 0.97418306045498e28 * t18 * legP[4] + 0.86000524892237e28 * t18 * legP[2] + 0.26546754306122e31 * t45 * legP[4] - 0.27846408459090e30 * t47 * legP[4] + 0.12019662927891e31 * t45 * legP[6] - 0.12558259082734e30 * t47 * legP[6] + 0.43808460958895e28 * t18 * legP[6] + 0.28432487150786e30 * t45 * legP[8] - 0.29578332396039e29 * t47 * legP[8] + 0.10276447286439e28 * t18 * legP[8] + 0.74618726839700e29 * t45 * legP[10] - 0.79139791626241e28 * t47 * legP[10] + 0.28024475662394e27 * t18 * legP[10];
	t82 = cosT * cosT;
	t86 = 0.40000000000000e-26 * sinT * (t38 + t79) / (t82 - 0.1e1);
	}
	else if (R<9.500000)
	{
	t16 = cosT * R;
	t19 = R * R;
	t20 = cosT * t19;
	t27 = t19 * R;
	t28 = t27 * cosT;
	t41 = 0.38238050247218e31 * cosT - 0.38238050247218e31 * cosT * legP[2] - 0.51203746334984e31 * cosT * legP[4] - 0.23006465952675e31 * cosT * legP[6] - 0.60304170270864e30 * cosT * legP[8] - 0.84267268315824e29 * cosT * legP[10] + 0.51203746334984e31 * legP[3] + 0.23006465952675e31 * legP[5] + 0.60304170270864e30 * legP[7] + 0.84267268315824e29 * legP[9] + 0.12262183326628e31 * t16 * legP[2] - 0.12959509275556e30 * t20 * legP[2] + 0.15788877751035e31 * t16 * legP[4] - 0.16216271642779e30 * t20 * legP[4] + 0.55507903103837e28 * t28 * legP[4] + 0.70230471595578e30 * t16 * legP[6] - 0.71565123061576e29 * t20 * legP[6] + 0.24342706809073e28 * t28 * legP[6] + 0.18382664908655e30 * t16 * legP[8] - 0.18713659701843e29 * t20 * legP[8];
	t79 = 0.63612499191610e27 * t28 * legP[8] + 0.25749663938192e29 * t16 * legP[10] - 0.26308372273259e28 * t20 * legP[10] + 0.89861263460037e26 * t28 * legP[10] + 0.45330152601676e28 * t28 * legP[2] - 0.70230471595578e30 * R * legP[5] + 0.71565123061576e29 * t19 * legP[5] - 0.24342706809073e28 * t27 * legP[5] - 0.18382664908655e30 * R * legP[7] + 0.18713659701843e29 * t19 * legP[7] - 0.63612499191610e27 * t27 * legP[7] - 0.25749663938192e29 * R * legP[9] + 0.26308372273259e28 * t19 * legP[9] - 0.89861263460037e26 * t27 * legP[9] - 0.12262183326628e31 * t16 + 0.12959509275556e30 * t20 - 0.45330152601676e28 * t28 - 0.15788877751035e31 * R * legP[3] + 0.16216271642779e30 * t19 * legP[3] - 0.55507903103837e28 * t27 * legP[3];
	t82 = cosT * cosT;
	t86 = 0.40000000000000e-26 * sinT * (t41 + t79) / (t82 - 0.1e1);
	}
	else if (R<9.750000)
	{
	t2 = cosT * R;
	t5 = R * R;
	t6 = t5 * cosT;
	t9 = t5 * R;
	t10 = cosT * t9;
	t44 = -0.11985796425607e31 * legP[9] + 0.22718438733335e32 * t2 * legP[2] - 0.24121937551510e31 * t6 * legP[2] + 0.84071138298936e29 * t10 * legP[2] + 0.33905231637518e32 * t2 * legP[4] - 0.34075318816779e31 * t6 * legP[4] + 0.11399733959311e30 * t10 * legP[4] + 0.15739553081869e32 * t2 * legP[6] - 0.15623274954776e31 * t6 * legP[6] + 0.51747057868380e29 * t10 * legP[6] + 0.43026712141286e31 * t2 * legP[8] - 0.42745220393338e30 * t6 * legP[8] + 0.14178537075229e29 * t10 * legP[8] - 0.41294092937553e30 * t2 * legP[10] + 0.46653614791513e29 * t6 * legP[10] - 0.17349215277230e28 * t10 * legP[10] + 0.69572934840474e32 * cosT - 0.69572934840474e32 * cosT * legP[2] - 0.11218910067896e33 * cosT * legP[4] - 0.52909184548887e32 * cosT * legP[6];
	t79 = -0.14462084735457e32 * cosT * legP[8] + 0.11985796425607e31 * cosT * legP[10] - 0.22718438733335e32 * t2 + 0.24121937551510e31 * t6 - 0.84071138298936e29 * t10 - 0.33905231637518e32 * R * legP[3] + 0.34075318816779e31 * t5 * legP[3] - 0.11399733959311e30 * t9 * legP[3] - 0.15739553081869e32 * R * legP[5] + 0.15623274954776e31 * t5 * legP[5] - 0.51747057868380e29 * t9 * legP[5] - 0.43026712141286e31 * R * legP[7] + 0.42745220393338e30 * t5 * legP[7] - 0.14178537075229e29 * t9 * legP[7] + 0.41294092937553e30 * R * legP[9] - 0.46653614791513e29 * t5 * legP[9] + 0.17349215277230e28 * t9 * legP[9] + 0.11218910067896e33 * legP[3] + 0.52909184548887e32 * legP[5] + 0.14462084735457e32 * legP[7];
	t82 = cosT * cosT;
	t86 = 0.10000000000000e-27 * sinT * (t44 + t79) / (t82 - 0.1e1);
	}
	else if (R<10.000000)
	{
	t16 = cosT * R;
	t18 = R * R;
	t19 = cosT * t18;
	t21 = t18 * R;
	t22 = cosT * t21;
	t38 = 0.40899111588369e32 * legP[3] + 0.20629679769939e32 * legP[5] + 0.44633084191545e31 * legP[7] + 0.23050876484691e31 * legP[9] + 0.18585173994554e32 * cosT - 0.18585173994554e32 * cosT * legP[2] - 0.40899111588369e32 * cosT * legP[4] - 0.20629679769939e32 * cosT * legP[6] - 0.44633084191545e31 * cosT * legP[8] - 0.23050876484691e31 * cosT * legP[10] - 0.63742060049186e31 * t16 + 0.69481345585769e30 * t19 - 0.24555794048003e29 * t22 - 0.12277096203032e32 * R * legP[3] + 0.12242254674310e31 * t18 * legP[3] - 0.40604123697140e29 * t21 * legP[3] - 0.60774957703179e31 * R * legP[5] + 0.59734007895759e30 * t18 * legP[5] - 0.19588959061328e29 * t21 * legP[5] - 0.12997251613492e31 * R * legP[7];
	t79 = 0.12638144086771e30 * t18 * legP[7] - 0.41031262778204e28 * t21 * legP[7] - 0.68718414138897e30 * R * legP[9] + 0.68330075278781e29 * t18 * legP[9] - 0.22661078745842e28 * t21 * legP[9] + 0.63742060049186e31 * t16 * legP[2] - 0.69481345585769e30 * t19 * legP[2] + 0.24555794048003e29 * t22 * legP[2] + 0.12277096203032e32 * t16 * legP[4] - 0.12242254674310e31 * t19 * legP[4] + 0.40604123697140e29 * t22 * legP[4] + 0.60774957703179e31 * t16 * legP[6] - 0.59734007895759e30 * t19 * legP[6] + 0.19588959061328e29 * t22 * legP[6] + 0.12997251613492e31 * t16 * legP[8] - 0.12638144086771e30 * t19 * legP[8] + 0.41031262778204e28 * t22 * legP[8] + 0.68718414138897e30 * t16 * legP[10] - 0.68330075278781e29 * t19 * legP[10] + 0.22661078745842e28 * t22 * legP[10];
	t82 = cosT * cosT;
	t86 = 0.20000000000000e-27 * sinT * (t38 + t79) / (t82 - 0.1e1);
	}
	else if (R<11.000000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.94668590595597e32 * cosT - 0.94668590595597e32 * cosT * legP[2] + 0.56219773901094e32 * cosT * legP[4] + 0.45543672915981e32 * cosT * legP[6] + 0.15278537020222e32 * cosT * legP[8] + 0.13176458192025e31 * cosT * legP[10] - 0.20414039113156e32 * t12 + 0.14674753576572e31 * t15 - 0.34962390061099e29 * t18 + 0.16939559435540e32 * R * legP[3] - 0.16591144148324e31 * t14 * legP[3] + 0.53269894988804e29 * t17 * legP[3] + 0.12549020268157e32 * R * legP[5] - 0.11508070460736e31 * t14 * legP[5] + 0.35136465829875e29 * t17 * legP[5] + 0.41908874620952e31 * R * legP[7] - 0.38317799353736e30 * t14 * legP[7] + 0.11676715606880e29 * t17 * legP[7] + 0.35187221424334e30 * R * legP[9] - 0.31303832823169e29 * t14 * legP[9];
	t79 = 0.92784808035423e27 * t17 * legP[9] - 0.56219773901094e32 * legP[3] - 0.45543672915981e32 * legP[5] - 0.15278537020222e32 * legP[7] - 0.13176458192025e31 * legP[9] + 0.20414039113156e32 * t12 * legP[2] - 0.14674753576572e31 * t15 * legP[2] + 0.34962390061099e29 * t18 * legP[2] - 0.16939559435540e32 * t12 * legP[4] + 0.16591144148324e31 * t15 * legP[4] - 0.53269894988804e29 * t18 * legP[4] - 0.12549020268157e32 * t12 * legP[6] + 0.11508070460736e31 * t15 * legP[6] - 0.35136465829875e29 * t18 * legP[6] - 0.41908874620952e31 * t12 * legP[8] + 0.38317799353736e30 * t15 * legP[8] - 0.11676715606880e29 * t18 * legP[8] - 0.35187221424334e30 * t12 * legP[10] + 0.31303832823169e29 * t15 * legP[10] - 0.92784808035423e27 * t18 * legP[10];
	t82 = cosT * cosT;
	t86 = -0.20000000000000e-28 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<12.000000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.66044074112163e32 * cosT - 0.66044074112163e32 * cosT * legP[2] - 0.22018867312808e32 * cosT * legP[4] - 0.22951052693868e31 * cosT * legP[6] - 0.73667617472400e30 * cosT * legP[8] + 0.30411465601460e30 * cosT * legP[10] - 0.15309686505949e32 * t12 + 0.11976164924079e31 * t15 - 0.31538128775375e29 * t18 - 0.52016987176906e31 * R * legP[3] + 0.41330446853477e30 * t14 * legP[3] - 0.11027527534415e29 * t17 * legP[3] - 0.56192851884272e30 * R * legP[5] + 0.46090899956002e29 * t14 * legP[5] - 0.12649314181782e28 * t17 * legP[5] - 0.18890481936195e30 * R * legP[7] + 0.16079053268548e29 * t14 * legP[7] - 0.45461340980912e27 * t17 * legP[7] + 0.79197492507128e29 * R * legP[9] - 0.68574969011714e28 * t14 * legP[9];
	t79 = 0.19742647925550e27 * t17 * legP[9] + 0.15309686505949e32 * t12 * legP[2] - 0.11976164924079e31 * t15 * legP[2] + 0.31538128775375e29 * t18 * legP[2] + 0.52016987176906e31 * t12 * legP[4] - 0.41330446853477e30 * t15 * legP[4] + 0.11027527534415e29 * t18 * legP[4] + 0.56192851884272e30 * t12 * legP[6] - 0.46090899956002e29 * t15 * legP[6] + 0.12649314181782e28 * t18 * legP[6] + 0.18890481936195e30 * t12 * legP[8] - 0.16079053268548e29 * t15 * legP[8] + 0.45461340980912e27 * t18 * legP[8] - 0.79197492507128e29 * t12 * legP[10] + 0.68574969011714e28 * t15 * legP[10] - 0.19742647925550e27 * t18 * legP[10] + 0.22018867312808e32 * legP[3] + 0.22951052693868e31 * legP[5] + 0.73667617472400e30 * legP[7] - 0.30411465601460e30 * legP[9];
	t82 = cosT * cosT;
	t86 = -0.40000000000000e-28 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<14.000000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.52500737914619e34 * cosT - 0.52500737914619e34 * cosT * legP[2] - 0.13849928296303e34 * cosT * legP[4] - 0.41690865504484e32 * cosT * legP[6] + 0.22419549600326e32 * cosT * legP[8] - 0.34283828235013e32 * cosT * legP[10] - 0.10722520434473e34 * t12 + 0.73716193669688e32 * t15 - 0.17018728436338e31 * t18 - 0.28564458530528e33 * R * legP[3] + 0.19769630520883e32 * t14 * legP[3] - 0.45852597393667e30 * t17 * legP[3] - 0.80531566753230e31 * R * legP[5] + 0.52380106676561e30 * t14 * legP[5] - 0.11475757956890e29 * t17 * legP[5] + 0.46577322638901e31 * R * legP[7] - 0.32074735764721e30 * t14 * legP[7] + 0.73150405758612e28 * t17 * legP[7] - 0.79371913580578e31 * R * legP[9] + 0.60989144138934e30 * t14 * legP[9];
	t79 = -0.15553338082890e29 * t17 * legP[9] + 0.13849928296303e34 * legP[3] + 0.41690865504484e32 * legP[5] - 0.22419549600326e32 * legP[7] + 0.34283828235013e32 * legP[9] + 0.10722520434473e34 * t12 * legP[2] - 0.73716193669688e32 * t15 * legP[2] + 0.17018728436338e31 * t18 * legP[2] + 0.28564458530528e33 * t12 * legP[4] - 0.19769630520883e32 * t15 * legP[4] + 0.45852597393667e30 * t18 * legP[4] + 0.80531566753230e31 * t12 * legP[6] - 0.52380106676561e30 * t15 * legP[6] + 0.11475757956890e29 * t18 * legP[6] - 0.46577322638901e31 * t12 * legP[8] + 0.32074735764721e30 * t15 * legP[8] - 0.73150405758612e28 * t18 * legP[8] + 0.79371913580578e31 * t12 * legP[10] - 0.60989144138934e30 * t15 * legP[10] + 0.15553338082890e29 * t18 * legP[10];
	t82 = cosT * cosT;
	t86 = -0.20000000000000e-30 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<16.000000)
	{
	t5 = cosT * R;
	t8 = R * R;
	t9 = t8 * cosT;
	t12 = t8 * R;
	t13 = cosT * t12;
	t41 = 0.75604725713674e32 * legP[3] + 0.51622151315585e31 * legP[5] - 0.46139981187220e31 * legP[7] - 0.11666124608332e32 * legP[9] + 0.54184284590230e32 * t5 * legP[2] - 0.31519965408798e31 * t9 * legP[2] + 0.61728880514581e29 * t13 * legP[2] + 0.13416114534767e32 * t5 * legP[4] - 0.79990535939559e30 * t9 * legP[4] + 0.16000487035950e29 * t13 * legP[4] + 0.88603890213874e30 * t5 * legP[6] - 0.50432390499122e29 * t9 * legP[6] + 0.95184719892999e27 * t13 * legP[6] - 0.95209964853830e30 * t5 * legP[8] + 0.65020166737928e29 * t9 * legP[8] - 0.14676488898255e28 * t13 * legP[8] - 0.23522196605752e31 * t5 * legP[10] + 0.15727838965907e30 * t9 * legP[10] - 0.34866952413348e28 * t13 * legP[10] + 0.31441772526471e33 * cosT;
	t79 = -0.31441772526471e33 * cosT * legP[2] - 0.75604725713674e32 * cosT * legP[4] - 0.51622151315585e31 * cosT * legP[6] + 0.46139981187220e31 * cosT * legP[8] + 0.11666124608332e32 * cosT * legP[10] - 0.54184284590230e32 * t5 + 0.31519965408798e31 * t9 - 0.61728880514581e29 * t13 - 0.13416114534767e32 * R * legP[3] + 0.79990535939559e30 * t8 * legP[3] - 0.16000487035950e29 * t12 * legP[3] - 0.88603890213874e30 * R * legP[5] + 0.50432390499122e29 * t8 * legP[5] - 0.95184719892999e27 * t12 * legP[5] + 0.95209964853830e30 * R * legP[7] - 0.65020166737928e29 * t8 * legP[7] + 0.14676488898255e28 * t12 * legP[7] + 0.23522196605752e31 * R * legP[9] - 0.15727838965907e30 * t8 * legP[9] + 0.34866952413348e28 * t12 * legP[9];
	t82 = cosT * cosT;
	t86 = -0.80000000000000e-30 * sinT * (t41 + t79) / (t82 - 0.1e1);
	}
	else if (R<18.000000)
	{
	t1 = cosT * R;
	t4 = R * R;
	t5 = t4 * R;
	t6 = t5 * cosT;
	t13 = cosT * t4;
	t41 = 0.11059740888526e31 * t1 * legP[8] + 0.25372065492817e28 * t6 * legP[10] + 0.10711865516261e31 * t1 * legP[6] + 0.24526743199561e32 * t1 * legP[2] - 0.12984002039630e31 * t13 * legP[2] + 0.11929248675333e28 * t6 * legP[6] + 0.23112290162151e29 * t6 * legP[2] + 0.43117941287924e31 * t1 * legP[4] - 0.23088533402216e30 * t13 * legP[4] + 0.41459031740038e28 * t6 * legP[4] - 0.62004118592082e29 * t13 * legP[6] - 0.63609441849000e29 * t13 * legP[8] + 0.12121346224022e28 * t6 * legP[8] + 0.22741369146182e31 * t1 * legP[10] - 0.13186889629052e30 * t13 * legP[10] + 0.27048350215140e32 * legP[3] + 0.61496692621577e31 * legP[5] + 0.63623951473627e31 * legP[7] + 0.13007777126033e32 * legP[9] + 0.15624417118115e33 * cosT;
	t79 = -0.15624417118115e33 * cosT * legP[2] - 0.27048350215140e32 * cosT * legP[4] - 0.61496692621577e31 * cosT * legP[6] - 0.63623951473627e31 * cosT * legP[8] - 0.13007777126033e32 * cosT * legP[10] - 0.24526743199561e32 * t1 + 0.12984002039630e31 * t13 - 0.23112290162151e29 * t6 - 0.43117941287924e31 * R * legP[3] + 0.23088533402216e30 * t4 * legP[3] - 0.41459031740038e28 * t5 * legP[3] - 0.10711865516261e31 * R * legP[5] + 0.62004118592082e29 * t4 * legP[5] - 0.11929248675333e28 * t5 * legP[5] - 0.11059740888526e31 * R * legP[7] + 0.63609441849000e29 * t4 * legP[7] - 0.12121346224022e28 * t5 * legP[7] - 0.22741369146182e31 * R * legP[9] + 0.13186889629052e30 * t4 * legP[9] - 0.25372065492817e28 * t5 * legP[9];
	t82 = cosT * cosT;
    t86 = -0.80000000000000e-30 * sinT * (t41 + t79) / (t82 - 0.1e1);
	}
	else if (R<20.000000)
	{
	t12 = cosT * R;
	t14 = R * R;
	t15 = cosT * t14;
	t17 = t14 * R;
	t18 = cosT * t17;
	t42 = 0.20985769209011e33 * cosT - 0.20985769209011e33 * cosT * legP[2] - 0.30480904932295e32 * cosT * legP[4] + 0.15781980038161e32 * cosT * legP[6] + 0.81145481605030e31 * cosT * legP[8] + 0.29185583389809e32 * cosT * legP[10] - 0.28920474025831e32 * t12 + 0.13499064396071e31 * t15 - 0.21269635162582e29 * t18 - 0.42950938604581e31 * R * legP[3] + 0.20398118860467e30 * t14 * legP[3] - 0.32584247796450e28 * t17 * legP[3] + 0.24453633079609e31 * R * legP[5] - 0.12587849865752e30 * t14 * legP[5] + 0.21522815118269e28 * t17 * legP[5] + 0.11701251029155e31 * R * legP[7] - 0.56341202510984e29 * t14 * legP[7] + 0.90662761977978e27 * t17 * legP[7] + 0.44395676571841e31 * R * legP[9] - 0.22453082126330e30 * t14 * legP[9];
	t79 = 0.37772183663064e28 * t17 * legP[9] + 0.56341202510984e29 * t15 * legP[8] + 0.28920474025831e32 * t12 * legP[2] - 0.13499064396071e31 * t15 * legP[2] + 0.21269635162582e29 * t18 * legP[2] + 0.42950938604581e31 * t12 * legP[4] - 0.20398118860467e30 * t15 * legP[4] + 0.32584247796450e28 * t18 * legP[4] - 0.24453633079609e31 * t12 * legP[6] + 0.12587849865752e30 * t15 * legP[6] - 0.21522815118269e28 * t18 * legP[6] - 0.11701251029155e31 * t12 * legP[8] - 0.90662761977978e27 * t18 * legP[8] - 0.44395676571841e31 * t12 * legP[10] + 0.22453082126330e30 * t15 * legP[10] - 0.37772183663064e28 * t18 * legP[10] + 0.30480904932295e32 * legP[3] - 0.15781980038161e32 * legP[5] - 0.81145481605030e31 * legP[7] - 0.29185583389809e32 * legP[9];
	t82 = cosT * cosT;
	t86 = -0.20000000000000e-30 * sinT * (t42 + t79) / (t82 - 0.1e1);
	}
	else if (R<25.000000)
	{
	t1 = R * R;
	t2 = cosT * t1;
	t4 = t1 * R;
	t5 = cosT * t4;
	t32 = cosT * R;
	t40 = 0.70505963798290e31 * t2 - 0.92933829713092e29 * t5 - 0.21197271998238e32 * R * legP[3] + 0.84439351154717e30 * t1 * legP[3] - 0.11247991250462e29 * t4 * legP[3] - 0.99780197091405e31 * R * legP[5] + 0.42669432026748e30 * t1 * legP[5] - 0.60254413204282e28 * t4 * legP[5] + 0.58750598460712e31 * R * legP[7] - 0.25045193960776e30 * t1 * legP[7] + 0.35263505520638e28 * t4 * legP[7] - 0.55269062246847e31 * R * legP[9] + 0.22529654315223e30 * t1 * legP[9] - 0.30541821475108e28 * t4 * legP[9] + 0.17825406390638e33 * legP[3] + 0.17945883227036e33 * t32 * legP[2] + 0.45076727992929e32 * legP[9] + 0.76928971692513e32 * legP[5] - 0.45441348461805e32 * legP[7] - 0.76928971692513e32 * cosT * legP[6];
	t79 = 0.45441348461805e32 * cosT * legP[8] - 0.45076727992929e32 * cosT * legP[10] - 0.17945883227036e33 * t32 + 0.15374828534938e34 * cosT - 0.15374828534938e34 * cosT * legP[2] - 0.17825406390638e33 * cosT * legP[4] - 0.22529654315223e30 * t2 * legP[10] + 0.30541821475108e28 * t5 * legP[10] - 0.58750598460712e31 * t32 * legP[8] + 0.25045193960776e30 * t2 * legP[8] - 0.35263505520638e28 * t5 * legP[8] + 0.55269062246847e31 * t32 * legP[10] + 0.11247991250462e29 * t5 * legP[4] + 0.99780197091405e31 * t32 * legP[6] - 0.42669432026748e30 * t2 * legP[6] + 0.60254413204282e28 * t5 * legP[6] - 0.70505963798290e31 * t2 * legP[2] + 0.92933829713092e29 * t5 * legP[2] + 0.21197271998238e32 * t32 * legP[4] - 0.84439351154717e30 * t2 * legP[4];
	t82 = cosT * cosT;
	t86 = -0.10000000000000e-31 * sinT * (t40 + t79) / (t82 - 0.1e1);
	}
	else if (R<30.000000)
	{
	t2 = cosT * R;
	t10 = R * R;
	t11 = t10 * cosT;
	t14 = t10 * R;
	t15 = cosT * t14;
	t41 = 0.13695588670909e32 * legP[3] + 0.21265098168275e31 * t2 * legP[4] + 0.14312209836498e33 * legP[5] - 0.78697711914119e32 * legP[7] + 0.20582466077526e32 * legP[9] + 0.15308294038700e32 * t2 * legP[6] - 0.54339793179333e30 * t11 * legP[6] + 0.64048464650905e28 * t15 * legP[6] - 0.83884803530583e31 * t2 * legP[8] + 0.29691534971001e30 * t11 * legP[8] - 0.34913929362329e28 * t15 * legP[8] + 0.21756487654704e31 * t2 * legP[10] - 0.76475215206707e29 * t11 * legP[10] + 0.89409893905344e27 * t15 * legP[10] - 0.12829876454920e32 * t2 * legP[2] + 0.12771897738033e28 * t15 * legP[4] + 0.19380278073294e30 * t11 * legP[2] + 0.10126796845970e27 * t15 * legP[2] - 0.93803813629015e29 * t11 * legP[4] - 0.21189709855965e33 * cosT;
	t79 = 0.21189709855965e33 * cosT * legP[2] - 0.13695588670909e32 * cosT * legP[4] - 0.14312209836498e33 * cosT * legP[6] + 0.78697711914119e32 * cosT * legP[8] - 0.20582466077526e32 * cosT * legP[10] + 0.12829876454920e32 * t2 - 0.19380278073294e30 * t11 - 0.10126796845970e27 * t15 - 0.21265098168275e31 * R * legP[3] + 0.93803813629015e29 * t10 * legP[3] - 0.12771897738033e28 * t14 * legP[3] - 0.15308294038700e32 * R * legP[5] + 0.54339793179333e30 * t10 * legP[5] - 0.64048464650905e28 * t14 * legP[5] + 0.83884803530583e31 * R * legP[7] - 0.29691534971001e30 * t10 * legP[7] + 0.34913929362329e28 * t14 * legP[7] - 0.21756487654704e31 * R * legP[9] + 0.76475215206707e29 * t10 * legP[9] - 0.89409893905344e27 * t14 * legP[9];
	t82 = cosT * cosT;
	t86 = 0.40000000000000e-32 * sinT * (t41 + t79) / (t82 - 0.1e1);
	}
	else
	{
	t1 = cosT * R;
	t36 = -0.70550835466651e29 * t1 + 0.70550835466651e29 * t1 * legP[2] + 0.51473737069596e31 * cosT - 0.51473737069596e31 * cosT * legP[2] - 0.15474570148836e29 * R * legP[3] + 0.15474570148836e29 * t1 * legP[4] + 0.58116685316478e30 * legP[3] - 0.58116685316478e30 * cosT * legP[4] - 0.19017169795074e28 * R * legP[5] + 0.19017169795074e28 * t1 * legP[6] + 0.56642350443792e29 * legP[5] - 0.56642350443792e29 * cosT * legP[6] - 0.30540847423525e27 * R * legP[7] + 0.30540847423525e27 * t1 * legP[8] + 0.88026991091605e28 * legP[7] - 0.88026991091605e28 * cosT * legP[8] + 0.87326874322046e27 * R * legP[9] - 0.87326874322046e27 * t1 * legP[10] - 0.26216611707566e29 * legP[9] + 0.26216611707566e29 * cosT * legP[10];
	t38 = R * R;
	t39 = t38 * t38;
	t42 = cosT * cosT;
	t86 = -0.40000000000000e-23 * sinT * t36 / t39 / t38 / (t42 - 0.1e1);
	}

	return t86;
}


double derivativeR(double R, double Theta)
{
	double t2, t5, t9, t13, t17, t18, t20, t21, t29;
	double cosT = cos(Theta);
	double *legP = legendre_array(10,cosT);

	if (R<4.500000)
	{
	t2 = exp(-0.15587635029119e1 * R);
	t5 = exp(-0.13910571666809e1 * R);
	t9 = exp(-0.11314491915437e1 * R);
	t13 = exp(-0.63429130737701e0 * R);
	t17 = exp(0.49580080306688e-1 * R);
	t21 = exp(-0.10290558301028e-1 * R);
	t29 = -0.65159012474174e8 * t2 - 0.67665092163508e8 * t5 * legP[2] - 0.84284155897546e7 * t9 * legP[4] - 0.13842075562043e6 * t13 * legP[6] + 0.99702997745164e2 * t17 * legP[8] - 0.62579898580716e1 * t21 * legP[10];
	}
	else if (R<4.750000)
	{
	t2 = R * R;
	t29 = -0.26840768764320e7 + 0.10684289205286e7 * R - 0.10777377882377e6 * t2 - 0.65871285639290e7 * legP[2] + 0.26638341296477e7 * legP[2] * R - 0.27306079208964e6 * legP[2] * t2 - 0.42874360880077e7 * legP[4] + 0.17973115786792e7 * legP[4] * R - 0.19023651677240e6 * legP[4] * t2 - 0.22234799340508e7 * legP[6] + 0.96245822967485e6 * legP[6] * R - 0.10447182774156e6 * legP[6] * t2 - 0.91535265960644e6 * legP[8] + 0.39960711733632e6 * legP[8] * R - 0.43592826854144e5 * legP[8] * t2 - 0.15102384289339e6 * legP[10] + 0.65920438737544e5 * legP[10] * R - 0.71913138879441e4 * legP[10] * t2;
	}
	else if (R<5.000000)
	{
	t2 = R * R;
	t29 = -0.19327271812782e6 + 0.19669274926868e5 * R + 0.26219733448471e4 * t2 + 0.11370355873102e7 * legP[2] - 0.58844551297981e6 * legP[2] * R + 0.69284433450083e5 * legP[2] * t2 + 0.25458878432538e7 * legP[4] - 0.10798774450099e7 * legP[4] * R + 0.11262548572119e6 * legP[4] * t2 + 0.18944562426054e7 * legP[6] - 0.77140963418045e6 * legP[6] * R + 0.78040578980052e5 * legP[6] * t2 + 0.69239806364932e6 * legP[8] - 0.27734055561344e6 * legP[8] * R + 0.27664822930046e5 * legP[8] * t2 + 0.66728604487741e5 * legP[10] - 0.25764802265041e5 * legP[10] * R + 0.24597641123277e4 * legP[10] * t2;
	}
	else if (R<5.250000)
	{
	t2 = R * R;
	t29 = -0.97559596627091e6 + 0.33259857418410e6 * R - 0.28670956580876e5 * t2 - 0.20399470918991e7 * legP[2] + 0.68234755870382e6 * legP[2] * R - 0.57794873718281e5 * legP[2] * t2 - 0.70271404655758e6 * legP[4] + 0.21956331091472e6 * legP[4] * R - 0.17318589871267e5 * legP[4] * t2 + 0.47083656654884e5 * legP[6] - 0.32460599800215e5 * legP[6] * R + 0.41456755420269e4 * legP[6] * t2 + 0.17749203536257e6 * legP[8] - 0.71378144298702e5 * legP[8] * R + 0.70685817985719e4 * legP[8] * t2 + 0.11479656222834e6 * legP[10] - 0.44991985361277e5 * legP[10] * R + 0.43824824219515e4 * legP[10] * t2;
	}
	else if (R<5.500000)
	{
	t2 = R * R;
	t29 = -0.68287420661811e6 + 0.22108552288780e6 * R - 0.18050665981227e5 * t2 - 0.14872226198824e7 * legP[2] + 0.47178585507843e6 * legP[2] * R - 0.37741378134911e5 * legP[2] * t2 - 0.60005660965372e6 * legP[4] + 0.18045571590374e6 * legP[4] * R - 0.13594057013077e5 * legP[4] * t2 - 0.96944533011222e5 * legP[6] + 0.22407281977348e5 * legP[6] * R - 0.10798370082173e4 * legP[6] * t2 - 0.15328191175934e5 * legP[8] + 0.20771800969134e4 * legP[8] * R + 0.72836618036883e2 * legP[8] * t2 - 0.23039728628803e5 * legP[10] + 0.75170778223979e4 * legP[10] * R - 0.61838073839836e3 * legP[10] * t2;
	}
	else if (R<5.750000)
	{
	t2 = R * R;
	t29 = -0.59747389640662e6 + 0.19003086462906e6 * R - 0.15227515230434e5 * t2 - 0.14564197344139e7 * legP[2] + 0.46058480581724e6 * legP[2] * R - 0.36723100929342e5 * legP[2] * t2 - 0.77923057237603e6 * legP[4] + 0.24560988416641e6 * legP[4] * R - 0.19517163218774e5 * legP[4] * t2 - 0.25784686210140e6 * legP[6] + 0.80917219828323e5 * legP[6] * R - 0.63989222673972e4 * legP[6] * t2 - 0.67119257346375e5 * legP[8] + 0.20910295067983e5 * legP[8] * R - 0.16392647429693e4 * legP[8] * t2 - 0.15549011873297e5 * legP[10] + 0.47931808203960e4 * legP[10] * R - 0.37075373821637e3 * legP[10] * t2;
	}
	else if (R<6.000000)
	{
	t2 = R * R;
	t29 = -0.43407426932413e6 + 0.13319621173082e6 * R - 0.10285371500151e5 * t2 - 0.10840341939401e7 * legP[2] + 0.33105940043501e6 * legP[2] * R - 0.25460022200452e5 * legP[2] * t2 - 0.59498778325547e6 * legP[4] + 0.18152543577665e6 * legP[4] * R - 0.13944602489231e5 * legP[4] * t2 - 0.20706552000086e6 * legP[6] + 0.63254144315091e5 * legP[6] * R - 0.48630026575501e4 * legP[6] * t2 - 0.61052018760838e5 * legP[8] + 0.18799951212142e5 * legP[8] * R - 0.14557565815919e4 * legP[8] * t2 - 0.17694641047982e5 * legP[10] + 0.55394866202862e4 * legP[10] * R - 0.43564989472853e3 * legP[10] * t2;
	}
	else if (R<6.250000)
	{
	t2 = R * R;
	t29 = -0.31803160851991e6 + 0.94515324796077e5 * R - 0.70619642555904e4 * t2 - 0.81374305173077e6 * legP[2] + 0.24096235303195e6 * legP[2] * R - 0.17951934916862e5 * legP[2] * t2 - 0.45647278959472e6 * legP[4] + 0.13535377122305e6 * legP[4] * R - 0.10096963776431e5 * legP[4] * t2 - 0.16197018244597e6 * legP[6] + 0.48222365130128e5 * legP[6] * R - 0.36103543921366e4 * legP[6] * t2 - 0.46236571277215e5 * legP[8] + 0.13861468717604e5 * legP[8] * R - 0.10442163737138e4 * legP[8] * t2 - 0.11310892533109e5 * legP[10] + 0.34115704486618e4 * legP[10] * R - 0.25832354709320e3 * legP[10] * t2;
	}
	else if (R<6.500000)
	{
	t2 = R * R;
	t29 = -0.22288367277713e6 + 0.64067985358381e5 * R - 0.46261771005747e4 * t2 - 0.57774598273630e6 * legP[2] + 0.16544329095369e6 * legP[2] * R - 0.11910409950602e5 * legP[2] * t2 - 0.32207975280116e6 * legP[4] + 0.92347999449118e5 * legP[4] * R - 0.66565020345158e4 * legP[4] * t2 - 0.11212500209757e6 * legP[6] + 0.32271907418640e5 * legP[6] * R - 0.23343177752180e4 * legP[6] * t2 - 0.31203722203094e5 * legP[8] + 0.90509570138831e4 * legP[8] * R - 0.65937543741618e3 * legP[8] * t2 - 0.77477953521589e4 * legP[10] + 0.22713793507582e4 * legP[10] * R - 0.16710825926087e3 * legP[10] * t2;
	}
	else if (R<6.750000)
	{
	t2 = R * R;
	t29 = -0.15419643467402e6 + 0.42933450557435e5 * R - 0.30004436543476e4 * t2 - 0.40512628387908e6 * legP[2] + 0.11232953745917e6 * legP[2] * R - 0.78247366048694e4 * legP[2] * t2 - 0.22417626011337e6 * legP[4] + 0.62223847852866e5 * legP[4] * R - 0.43392596040353e4 * legP[4] * t2 - 0.76114659601186e5 * legP[6] + 0.21191802035137e5 * legP[6] * R - 0.14820019764869e4 * legP[6] * t2 - 0.19821439342455e5 * legP[8] + 0.55487161336869e4 * legP[8] * R - 0.38997229278566e3 * legP[8] * t2 - 0.43664162620991e4 * legP[10] + 0.12309550153549e4 * legP[10] * R - 0.87075618076012e2 * legP[10] * t2;
	}
	else if (R<7.000000)
	{
	t2 = R * R;
	t29 = -0.10450267365021e6 + 0.28209373217041e5 * R - 0.19097712587632e4 * t2 - 0.27842206346505e6 * legP[2] + 0.74787546225385e5 * legP[2] * R - 0.50438483653306e4 * legP[2] * t2 - 0.15263969922288e6 * legP[4] + 0.41027829811244e5 * legP[4] * R - 0.27691841935450e4 * legP[4] * t2 - 0.50694393466238e5 * legP[6] + 0.13659871328487e5 * legP[6] * R - 0.92408118340170e3 * legP[6] * t2 - 0.12549946625991e5 * legP[8] + 0.33941997732539e4 * legP[8] * R - 0.23037848830911e3 * legP[8] * t2 - 0.25497955321230e4 * legP[10] + 0.69269702128802e3 * legP[10] * R - 0.47204655552549e2 * legP[10] * t2;
	}
	else if (R<7.250000)
	{
	t2 = R * R;
	t29 = -0.69688272061569e5 + 0.18262401334574e5 * R - 0.11992732671582e4 * t2 - 0.18880539857133e6 * legP[2] + 0.49182784827174e5 * legP[2] * R - 0.32149368368868e4 * legP[2] * t2 - 0.10270490415437e6 * legP[4] + 0.26760745505953e5 * legP[4] * R - 0.17501067431670e4 * legP[4] * t2 - 0.33569136205528e5 * legP[6] + 0.87669406825703e4 * legP[6] * R - 0.57458613726475e3 * legP[6] * t2 - 0.80997694677585e4 * legP[8] + 0.21227205851871e4 * legP[8] * R - 0.13955854630437e3 * legP[8] * t2 - 0.15722478899419e4 * legP[10] + 0.41339769495047e3 * legP[10] * R - 0.27254703671292e2 * legP[10] * t2;
	}
	else if (R<7.500000)
	{
	t2 = R * R;
	t29 = -0.45585329671514e5 + 0.11613313778697e5 * R - 0.74071550468404e3 * t2 - 0.12607119784184e6 * legP[2] + 0.31876798419043e5 * legP[2] * R - 0.20214205328778e4 * legP[2] * t2 - 0.68034078890025e5 * legP[4] + 0.17196379915791e5 * legP[4] * R - 0.10904953231558e4 * legP[4] * t2 - 0.21856949567627e5 * legP[6] + 0.55359926445275e4 * legP[6] * R - 0.35176213464113e3 * legP[6] * t2 - 0.51625108845234e4 * legP[8] + 0.13124423553292e4 * legP[8] * R - 0.83677289072790e2 * legP[8] * t2 - 0.99403897841554e3 * legP[10] + 0.25389178832256e3 * legP[10] * R - 0.16254296317642e2 * legP[10] * t2;
	}
	else if (R<7.750000)
	{
	t2 = R * R;
	t29 = -0.29216020962400e5 + 0.72481647895990e4 * R - 0.44970557207754e3 * t2 - 0.82996153148051e5 * legP[2] + 0.20390119834032e5 * legP[2] * R - 0.12556419605438e4 * legP[2] * t2 - 0.44466385899790e5 * legP[4] + 0.10911661785060e5 * legP[4] * R - 0.67151411444045e3 * legP[4] * t2 - 0.13998015179658e5 * legP[6] + 0.34402768077362e4 * legP[6] * R - 0.21204774552169e3 * legP[6] * t2 - 0.32193703961786e4 * legP[8] + 0.79427155843742e3 * legP[8] * R - 0.49132569279999e2 * legP[8] * t2 - 0.60799916400212e3 * legP[10] + 0.15094783781232e3 * legP[10] * R - 0.93913662836260e1 * legP[10] * t2;
	}
	else if (R<8.000000)
	{
	t2 = R * R;
	t29 = -0.18281627164711e5 + 0.44263857450342e4 * R - 0.26765531113787e3 * t2 - 0.53868501797565e5 * legP[2] + 0.12873306582292e5 * legP[2] * R - 0.77068626688327e3 * legP[2] * t2 - 0.28733790976343e5 * legP[4] + 0.68516372886876e4 * legP[4] * R - 0.40957705015830e3 * legP[4] * t2 - 0.88816441092494e4 * legP[6] + 0.21199229831147e4 * legP[6] * R - 0.12686362780419e3 * legP[6] * t2 - 0.19587397928962e4 * legP[8] + 0.46894753178382e3 * legP[8] * R - 0.28143922399117e2 * legP[8] * t2 - 0.34516102815084e3 * legP[10] + 0.83118641463596e2 * legP[10] * R - 0.50152890998365e1 * legP[10] * t2;
	}
	else if (R<8.250000)
	{
	t2 = R * R;
	t29 = -0.11095773475205e5 + 0.26299223226575e4 * R - 0.15537634723930e3 * t2 - 0.34434357797203e5 * legP[2] + 0.80147705822023e4 * legP[2] * R - 0.46702776687758e3 * legP[2] * t2 - 0.18366192589043e5 * legP[4] + 0.42597376918621e4 * legP[4] * R - 0.24758332535673e3 * legP[4] * t2 - 0.55645659309456e4 * legP[6] + 0.12906534385386e4 * legP[6] * R - 0.75034281268186e2 * legP[6] * t2 - 0.11832284190423e4 * legP[8] + 0.27506968832031e3 * legP[8] * R - 0.16026557182654e2 * legP[8] * t2 - 0.19178470196181e3 * legP[10] + 0.44774559916339e2 * legP[10] * R - 0.26187840031336e1 * legP[10] * t2;
	}
	else if (R<8.500000)
	{
	t2 = R * R;
	t29 = -0.64531575400234e4 + 0.15044396717048e4 * R - 0.87165277484611e2 * t2 - 0.21629675441768e5 * legP[2] + 0.49106051627033e4 * legP[2] * R - 0.27889652933220e3 * legP[2] * t2 - 0.11618020745266e5 * legP[4] + 0.26238172448861e4 * legP[4] * R - 0.14843663160058e3 * legP[4] * t2 - 0.34933333822601e4 * legP[6] + 0.78853645703905e3 * legP[6] * R - 0.44602949056099e2 * legP[6] * t2 - 0.72939395957583e3 * legP[8] + 0.16504921329817e3 * legP[8] * R - 0.93586496055515e1 * legP[8] * t2 - 0.11580712258063e3 * legP[10] + 0.26355752793630e2 * legP[10] * R - 0.15024926623634e1 * legP[10] * t2;
	}
	else if (R<8.750000)
	{
	t2 = R * R;
	t29 = -0.35129493342059e4 + 0.81262597621852e3 * R - 0.46470354220697e2 * t2 - 0.13280207173254e5 * legP[2] + 0.29460243936415e4 * legP[2] * R - 0.16333295468145e3 * legP[2] * t2 - 0.72356097172677e4 * legP[4] + 0.15926617088864e4 * legP[4] * R - 0.87780423600612e2 * legP[4] * t2 - 0.21517373697414e4 * legP[6] + 0.47286680703463e3 * legP[6] * R - 0.26034146114663e2 * legP[6] * t2 - 0.42271948153345e3 * legP[8] + 0.92890512582302e2 * legP[8] * R - 0.51140201516781e1 * legP[8] * t2 - 0.69714214288910e2 * legP[10] + 0.15510362607343e2 * legP[10] * R - 0.86452853375841e0 * legP[10] * t2;
	}
	else if (R<9.000000)
	{
	t2 = R * R;
	t29 = -0.16876210328971e4 + 0.39540807877647e3 * R - 0.22629331509723e2 * t2 - 0.79231864339338e4 * legP[2] + 0.17215625103678e4 * legP[2] * R - 0.93363704208693e2 * legP[2] * t2 - 0.44402772467300e4 * legP[4] + 0.95372857276341e3 * legP[4] * R - 0.51269958679296e2 * legP[4] * t2 - 0.13124871113964e4 * legP[6] + 0.28103817655577e3 * legP[6] * R - 0.15072510087297e2 * legP[6] * t2 - 0.27054770448024e3 * legP[8] + 0.58108392112997e2 * legP[8] * R - 0.31264704105740e1 * legP[8] * t2 - 0.19328802479050e2 * legP[10] + 0.39936970508041e1 * legP[10] * R - 0.20643335909896e0 * legP[10] * t2;
	}
	else if (R<9.250000)
	{
	t2 = R * R;
	t29 = -0.59880600510103e3 + 0.15344918371067e3 * R - 0.91871706727356e1 * t2 - 0.45403519027921e4 * legP[2] + 0.96982150344748e3 * legP[2] * R - 0.51600314935347e2 * legP[2] * t2 - 0.26546754306122e4 * legP[4] + 0.55692816918178e3 * legP[4] * R - 0.29225491813650e2 * legP[4] * t2 - 0.80131086185941e3 * legP[6] + 0.16744345443645e3 * legP[6] * R - 0.87616921917790e1 * legP[6] * t2 - 0.14216243575394e3 * legP[8] + 0.29578332396039e2 * legP[8] * R - 0.15414670929658e1 * legP[8] * t2 - 0.29847490735882e2 * legP[10] + 0.63311833300991e1 * legP[10] * R - 0.33629370794871e0 * legP[10] * t2;
	}
	else if (R<9.500000)
	{
	t2 = R * R;
	t29 = 0.29434737744313e2 + 0.17613347419779e2 * R - 0.18446930353908e1 * t2 - 0.24524366653255e4 * legP[2] + 0.51838037102224e3 * legP[2] * R - 0.27198091561004e2 * legP[2] * t2 - 0.15788877751035e4 * legP[4] + 0.32432543285558e3 * legP[4] * R - 0.16652370931151e2 * legP[4] * t2 - 0.46820314397052e3 * legP[6] + 0.95420164082101e2 * legP[6] * R - 0.48685413618143e1 * legP[6] * t2 - 0.91913324543280e2 * legP[8] + 0.18713659701843e2 * legP[8] * R - 0.95418748787416e0 * legP[8] * t2 - 0.10299865575276e2 * legP[10] + 0.21046697818608e1 * legP[10] * R - 0.10783351615205e0 * legP[10] * t2;
	}
	else if (R<9.750000)
	{
	t2 = R * R;
	t29 = 0.35009658610069e3 - 0.49894410128930e2 * R + 0.17083468355939e1 * t2 - 0.11359219366667e4 * legP[2] + 0.24121937551510e3 * legP[2] * R - 0.12610670744841e2 * legP[2] * t2 - 0.84763079093796e3 * legP[4] + 0.17037659408390e3 * legP[4] * R - 0.85498004694829e1 * legP[4] * t2 - 0.26232588469779e3 * legP[6] + 0.52077583182591e2 * legP[6] * R - 0.25873528934191e1 * legP[6] * t2 - 0.53783390176607e2 * legP[8] + 0.10686305098334e2 * legP[8] * R - 0.53169514032113e0 * legP[8] * t2 + 0.41294092937553e1 * legP[10] - 0.93307229583026e0 * legP[10] * R + 0.52047645831691e-1 * legP[10] * t2;
	}
	else if (R<10.000000)
	{
	t2 = R * R;
	t29 = 0.54693928662876e3 - 0.90272399980838e2 * R + 0.37790129818463e1 * t2 - 0.63742060049181e3 * legP[2] + 0.13896269117155e3 * legP[2] * R - 0.73667382144015e1 * legP[2] * t2 - 0.61385481015156e3 * legP[4] + 0.12242254674311e3 * legP[4] * R - 0.60906185545711e1 * legP[4] * t2 - 0.20258319234392e3 * legP[6] + 0.39822671930503e2 * legP[6] * R - 0.19588959061330e1 * legP[6] * t2 - 0.32493129033732e2 * legP[8] + 0.63190720433853e1 * legP[8] * R - 0.30773447083654e0 * legP[8] * t2 - 0.13743682827779e2 * legP[10] + 0.27332030111514e1 * legP[10] * R - 0.13596647247506e0 * legP[10] * t2;
	}
	else if (R<11.000000)
	{
	t2 = R * R;
	t29 = 0.52974183965278e3 - 0.86832910585639e2 * R + 0.36070385120862e1 * t2 + 0.20414039113156e3 * legP[2] - 0.29349507153144e2 * legP[2] * R + 0.10488717018329e1 * legP[2] * t2 - 0.84697797177695e2 * legP[4] + 0.16591144148322e2 * legP[4] * R - 0.79904842483203e0 * legP[4] * t2 - 0.41830067560524e2 * legP[6] + 0.76720469738247e1 * legP[6] * R - 0.35136465829875e0 * legP[6] * t2 - 0.10477218655238e2 * legP[8] + 0.19158899676867e1 * legP[8] * R - 0.87575367051609e-1 * legP[8] * t2 - 0.70374442848669e0 * legP[10] + 0.12521533129267e0 * legP[10] * R - 0.55670884821252e-2 * legP[10] * t2;
	}
	else if (R<12.000000)
	{
	t2 = R * R;
	t29 = 0.34651527437815e3 - 0.53518989626619e2 * R + 0.20927693775854e1 * t2 + 0.30619373011896e3 * legP[2] - 0.47904659696315e2 * legP[2] * R + 0.18922877265225e1 * legP[2] * t2 + 0.52016987176902e2 * legP[4] - 0.82660893706956e1 * legP[4] * R + 0.33082582603248e0 * legP[4] * t2 + 0.37461901256181e1 * legP[6] - 0.61454533274667e0 * legP[6] * R + 0.25298628363566e-1 * legP[6] * t2 + 0.94452409680984e0 * legP[8] - 0.16079053268547e0 * legP[8] * R + 0.68192011471370e-2 * legP[8] * t2 - 0.31678997002852e0 * legP[10] + 0.54859975209372e-1 * legP[10] * R - 0.23691177510662e-2 * legP[10] * t2;
	}
	else if (R<14.000000)
	{
	t2 = R * R;
	t29 = 0.13751319478192e3 - 0.18685309693919e2 * R + 0.64136604705578e0 * t2 + 0.10722520434472e3 * legP[2] - 0.14743238733939e2 * legP[2] * R + 0.51056185309017e0 * legP[2] * t2 + 0.14282229265264e2 * legP[4] - 0.19769630520883e1 * legP[4] * R + 0.68778896090500e-1 * legP[4] * t2 + 0.26843855584410e0 * legP[6] - 0.34920071117706e-1 * legP[6] * R + 0.11475757956889e-2 * legP[6] * t2 - 0.11644330659724e0 * legP[8] + 0.16037367882360e-1 * legP[8] * R - 0.54862804318964e-3 * legP[8] * t2 + 0.15874382716116e0 * legP[10] - 0.24395657655572e-1 * legP[10] * R + 0.93320028497343e-3 * legP[10] * t2;
	}
	else if (R<16.000000)
	{
	t2 = R * R;
	t29 = 0.33852253206467e2 - 0.38766037545672e1 * R + 0.11248369207897e0 * t2 + 0.21673713836093e2 * legP[2] - 0.25215972327039e1 * legP[2] * R + 0.74074656617498e-1 * legP[2] * t2 + 0.26832229069536e1 * legP[4] - 0.31996214375825e0 * legP[4] * R + 0.96002922215705e-2 * legP[4] * t2 + 0.11813852028517e0 * legP[6] - 0.13448637466433e-1 * legP[6] * R + 0.38073887957201e-3 * legP[6] * t2 - 0.95209964853835e-1 * legP[8] + 0.13004033347586e-1 * legP[8] * R - 0.44029466694763e-3 * legP[8] * t2 - 0.18817757284602e0 * legP[10] + 0.25164542345451e-1 * legP[10] * R - 0.83680685792042e-3 * legP[10] * t2;
	}
	else if (R<18.000000)
	{
	t2 = R * R;
	t29 = 0.16840413818581e2 - 0.17501238310814e1 * R + 0.46031194470044e-1 * t2 + 0.98106972798250e1 * legP[2] - 0.10387201631705e1 * legP[2] * R + 0.27734748194582e-1 * legP[2] * t2 + 0.86235882575856e0 * legP[4] - 0.92354133608861e-1 * legP[4] * R + 0.24875419044023e-2 * legP[4] * t2 + 0.14282487355014e0 * legP[6] - 0.16534431624555e-1 * legP[6] * R + 0.47716994701335e-3 * legP[6] * t2 + 0.11059740888526e0 * legP[8] - 0.12721888369800e-1 * legP[8] * R + 0.36364038672065e-3 * legP[8] * t2 + 0.18193095316946e0 * legP[10] - 0.21099023406482e-1 * legP[10] * R + 0.60892957182762e-3 * legP[10] * t2;
	}
	else if (R<20.000000)
	{
	t2 = R * R;
	t29 = 0.64489903184056e1 - 0.59552121995064e0 * R + 0.13958899716419e-1 * t2 + 0.28920474025830e1 * legP[2] - 0.26998128792141e0 * legP[2] * R + 0.63808905487745e-2 * legP[2] * t2 + 0.21475469302291e0 * legP[4] - 0.20398118860467e-1 * legP[4] * R + 0.48876371694677e-3 * legP[4] * t2 - 0.81512110265356e-1 * legP[6] + 0.83918999105011e-2 * legP[6] * R - 0.21522815118269e-3 * legP[6] * t2 - 0.29253127572888e-1 * legP[8] + 0.28170601255492e-2 * legP[8] * R - 0.67997071483482e-4 * legP[8] * t2 - 0.88791353143683e-1 * legP[10] + 0.89812328505324e-2 * legP[10] * R - 0.22663310197839e-3 * legP[10] * t2;
	}
	else if (R<25.000000)
    {	
	t2 = R * R;
	t29 = 0.22145776515430e1 - 0.17207995326431e0 * R + 0.33728680492627e-2 * t2 + 0.89729416135182e0 * legP[2] - 0.70505963798286e-1 * legP[2] * R + 0.13940074456964e-2 * legP[2] * t2 + 0.52993179995591e-1 * legP[4] - 0.42219675577357e-2 * legP[4] * R + 0.84359934378467e-4 * legP[4] * t2 + 0.16630032848569e-1 * legP[6] - 0.14223144008916e-2 * legP[6] * R + 0.30127206602141e-4 * legP[6] * t2 - 0.73438248075890e-2 * legP[8] + 0.62612984901941e-3 * legP[8] * R - 0.13223814570240e-4 * legP[8] * t2 + 0.55269062246851e-2 * legP[10] - 0.45059308630448e-3 * legP[10] * R + 0.91625464425330e-5 * legP[10] * t2;
	}
	else if (R<30.000000)
	{
	t2 = R * R;
	t29 = 0.18335108907193e0 - 0.95818282666456e-2 * R + 0.12290554930943e-3 * t2 + 0.25659752909842e-1 * legP[2] - 0.77521112293175e-3 * legP[2] * R - 0.60760781075821e-6 * legP[2] * t2 - 0.21265098168277e-2 * legP[4] + 0.18760762725804e-3 * legP[4] * R - 0.38315693214103e-5 * legP[4] * t2 - 0.10205529359134e-1 * legP[6] + 0.72453057572446e-3 * legP[6] * R - 0.12809692930181e-4 * legP[6] * t2 + 0.41942401765291e-2 * legP[8] - 0.29691534971002e-3 * legP[8] * R + 0.52370894043492e-5 * legP[8] * t2 - 0.87025950618816e-3 * legP[10] + 0.61180172165365e-4 * legP[10] * R - 0.10729187268641e-5 * legP[10] * t2;
	}
	else
	{
	t17 = 0.22412595812165e30 * R - 0.77924138401281e32 + 0.35275417733325e30 * legP[2] * R - 0.30884242241757e32 * legP[2] + 0.38686425372090e29 * legP[4] * R - 0.17435005594943e31 * legP[4] + 0.31695282991791e28 * legP[6] * R - 0.11328470088759e30 * legP[6] + 0.38176059279406e27 * legP[8] * R - 0.13204048663741e29 * legP[8] - 0.87326874322043e27 * legP[10] * R + 0.31459934049078e29 * legP[10];
	t18 = R * R;
	t20 = t18 * t18;
	t29 = -0.20000000000000e-23 * t17 / t20 / t18 / R;
	}

	return t29;
}

void rhs(double* out, double R, double theta, double pR, double pT, double alpha, double beta, double J)
// input:
//      out -- prepared array to fill the right-hand sides of ODEs
{
    double Jsint = J * sin(theta);

    double* derivatives = new double[6];
    hamiltonian(derivatives, R, theta, pR, pT, alpha, beta, J);
    
    out[0] = derivatives[2]; // /dot(R) = dH/dpR
    out[1] = derivatives[3]; // /dot(theta) = dH/dpT
    out[2] = - derivatives[0] - derivativeR(R, theta) / 2.1947 * pow(10, -5); // /dot(pR) = - dH/dR = - dT/dR - dU/dR (to hartrees from cm^-1)
    out[3] = - derivatives[1] - derivativeTheta(R, theta) / 2.1947 * pow(10, -5); // /dot(pT) = - dH/dtheta = -dT/dtheta - dU/dtheta (to hartrees from cm^-1)
    out[4] = 1 / Jsint * derivatives[4]; // /dot(varphi) = 1 / J / sin(teta) * dH/dtheta
    out[5] = - 1 / Jsint * derivatives[5]; // /dot(theta) = - 1 / J / sin(theta) * dH/dvarphi

    delete[] derivatives;
}

int main()
{
    double R = 5.0;
    double theta = M_PI / 2;
    double J = 10;
    double alpha = 0.05;
    double beta = 0.55;
    double pR = -10.;
    double pT = 0.1;

    std::chrono::time_point<std::chrono::system_clock> start, end;
    start = std::chrono::system_clock::now(); 

    //double* output = new double[6];
    double *derivatives = new double[6];

    for (int i = 0; i < 1; i++)
    {
        hamiltonian(derivatives, R, theta, pR, pT, J, alpha, beta);
        //rhs(output, R, theta, pR, pT, J, alpha, beta);
    }

    delete[] derivatives;
    //delete[] output;

    end = std::chrono::system_clock::now();
    std::chrono::duration<double> elapsed_seconds = end - start;
    std::cout << "elapsed time: " << elapsed_seconds.count() / 100000 * pow(10, 6) << "microseconds\n";

    return 0;
}
