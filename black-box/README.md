<p align="center"><img src="https://rawgit.com/artfin/sympy/master/svgs/8a2672a9d198c16c13f914a7f57abb14.svg?invert_in_darkmode" align=middle width=139.28805pt height=68.9865pt/></p>


Для определения производных гамильтониана <img src="https://rawgit.com/artfin/sympy/master/svgs/5ab89f0a8095aee9c118de6f5ad7da4c.svg?invert_in_darkmode" align=middle width=92.300505pt height=24.56553pt/> по углам, определяющим направление углового момента, используем цепное правило:


<p align="center"><img src="https://rawgit.com/artfin/sympy/master/svgs/35aeb4ff64608544589d4af478ff3ec8.svg?invert_in_darkmode" align=middle width=576.91095pt height=36.953895pt/></p>

Подставив производные компонент углового момента по переменным <img src="https://rawgit.com/artfin/sympy/master/svgs/c22256e41f3c442e6d8cbe819f6ac73d.svg?invert_in_darkmode" align=middle width=42.2697pt height=22.74591pt/>, получаем следующую систему линейных уравнений, связывающие производные по старым и новым переменным.

<p align="center"><img src="https://rawgit.com/artfin/sympy/master/svgs/b4d58b6c815081bbcf083c4dffd24d46.svg?invert_in_darkmode" align=middle width=451.64955pt height=62.85213pt/></p>

